%\documentclass[11pt,a4paper]{scrbook}
\documentclass[12pt,a4paper,listof=totoc,captions=nooneline]{scrreprt} 
\usepackage{geometry}	
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[pdftex]{graphicx}
\usepackage{graphicx}
\usepackage[ngerman]{babel}
\usepackage{colortbl}	
\usepackage{xcolor}
\usepackage{soul}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
%\usepackage{tocloft}
\usepackage[colorlinks,
pdfpagelabels,
pdfstartview = FitH,
bookmarksopen = true,
bookmarksnumbered = true,
linkcolor = black,
plainpages = false,
hypertexnames = false,
citecolor = black] {hyperref}
\usepackage{amsmath, amssymb, amstext, amsfonts, mathrsfs}	% Mathe
\usepackage{selinput} 
\SelectInputMappings{ 
adieresis={ä}, 
germandbls={ß}, 
}
\renewcommand{\familydefault}{\sfdefault}
\usepackage{graphicx}
\usepackage[onehalfspacing]{setspace}

\usepackage{chngcntr}
\counterwithout{equation}{chapter}


\definecolor{uhhred}{cmyk}{0,100,100,0}

\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}
\addtokomafont{caption}{\centering}
\AfterTOCHead[lof]{\renewcommand*{\numberline}[1]{\nonumberline}}
\AfterTOCHead[toc]{\renewcommand*{\numberline}[1]{\nonumberline}}

\usepackage{selinput} 
\SelectInputMappings{ 
adieresis={ä}, 
germandbls={ß}, 
}
\renewcommand{\familydefault}{\sfdefault}
\usepackage{graphicx}
\usepackage[onehalfspacing]{setspace}


\definecolor{uhhred}{cmyk}{0,100,100,0}

\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}
\addtokomafont{caption}{\centering}
\AfterTOCHead[lof]{\renewcommand*{\numberline}[1]{\nonumberline}}
\AfterTOCHead[toc]{\renewcommand*{\numberline}[1]{\nonumberline}}

\begin{document}
\setlength{\parindent}{0pt}
%\frontmatter
\newgeometry{centering,left=2cm,right=2cm,top=2cm,bottom=2cm}
\begin{titlepage}
\includegraphics[scale=0.3]{UHH-Logo_2010_Farbe_CMYK.pdf}
\vspace*{2cm}
\Large
\begin{center} 
      {\color{uhhred}\textbf{\so{Labreport, Gruppe 4 }}}
%oder {\color{uhhred}\textbf{\so{MASTERTHESIS}}}
\vspace*{2.0cm}\\
{\LARGE \textbf{Projekt Netzwerk-Infrastruktur WS 2017/18}}
\vspace*{2.0cm}\\
\textbf{Dozent: Robert Olotu}\\ 
vorgelegt von
\vspace*{0.4cm}\\
\textbf{Dewin Bagci:} 5bagci@informatik.uni-hamburg.de (6815336)\\ \textbf{Karan Popat:} karan.popat@outlook.de (6600283) \\ \textbf{ Hanife Demircioglu:} h.demircioglu@hotmail.de (6816065) \\ 
\end{center}
\vspace*{3.9cm}

\noindent 
MIN-Fakultät \vspace*{0.4cm} \\ 
Fachbereich Informatik \\
Abgabedatum: 01.03.2018\\


\end{titlepage}

\restoregeometry

\tableofcontents

%\chapter{Abkürzungsverzeichnis}

\listoffigures
%\mainmatter 


\chapter*{Part 3: Network Troubleshooting Utilities}
\addcontentsline{toc}{chapter}{Part 3: Network Troubleshooting Utilities} 

%\begin{figure}[H]
%\begin{subfigure}{0.5\textwidth}

%\includegraphics[width=0.75\textwidth]{UHH-Logo_2010_Farbe_CMYK.pdf}
%\subcaption{Subfigure Bild Nr. 1}

%\end{subfigure}
%\begin{subfigure}{0.5\textwidth}
%\includegraphics[width=0.75\textwidth]{Bild2.png}
%\subcaption{Subfigure Bild Nr. 2}
%\end{subfigure}
%\caption[Abbildung 1: Broadcast und Multicast]{Broadcast und Multicast}
%\end{figure}


\section*{Exercise 6: Managing Services (Please use pnidX-svr-mu)}
\addcontentsline{toc}{section}{Exercise 6: Managing Services (Please use pnidX-svr-mu} 
Please type and explain the meaning of the following commands:\\
1)\# chkconfig \\
2)\# \verb|chkonfig --list iptables| \\
3)\# \verb|chkconfig --level 2 iptables off| \\
4)\# \verb|chkconfig --level 2345 iptables off| \\
5)\# chkconfig iptables on | off \\
6)\# chkconfig tftp on \\
7)\# \verb|chkconfig --level 2 vsftpd off| \\
8)\# \verb|chkconfig --level 2345 vsftpd off| \\
9)\# Explain the function of xinetd \\
The super server xinetd controlled services are automatically enabled or disabled by chkconfig. \\
Please type and explain the meaning of the following commands: \\
10)\# service network stop \\
11)\# service network start \\ \\ 
Please type and explain the meaning of the following commands: \\
1) \# chkconfig \\
Die folgenden Kommandos wurden auf Rechner pnid4-svr-mu mit dem Betriebssystem Centos-6.5-x86\_64 ausgeführt. \\
Zeigt an welche Dienste in ihren jeweiligen runlevels aktiviert bzw. deaktiviert sind [siehe Abb. 1] 
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_3/b1.PNG}
\end{center}
\caption[Abbildung 1: aktivierte bzw. deaktivierte Dienste eines runlevels]{aktivierte bzw. deaktivierte Dienste eines runlevels}
\end{figure}

2)\# \verb|chkonfig -- list iptables|\\
Zeigt an in welchen runlevel iptables eingeschaltet bzw. ausgeschaltet ist. [Abb. 2]
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b2.png}
\end{center}
\caption[Abbildung 2: Runlevel, in denen iptables eingeschaltet bzw. ausgeschaltet sind]{Runlevels, in denen iptables eingeschaltet bzw. ausgeschaltet sind}
\end{figure}

3)\# \verb|chkconfig --level 2 iptables off| \\
Deaktiviert iptables im runlevel 2. [Abb. 3]. Wir sehen, dass zuvor iptables im runlevel 2 aktiviert war. 
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b3.png}
\end{center}
\caption[Abbildung 3: ]{runlevel 2 wird ausgeschaltet}
\end{figure}

4)\# \verb|chkconfig --level 2345 iptables off|\\
Deaktiviert iptables im runlevel 2, 3, 4 und 5. [Abb. 4]
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b4.png}
\end{center}
\caption[Abbildung 4: Runlevel 2,3,4,5 werden deaktiviert]{Runlevel 2,3,4,5 werden deaktiviert}
\end{figure}

5)\# chkconfig iptables on | off \\ Mit iptables off wird iptables auf jedem runlevel deaktiviert. Mit iptables on wird iptables auf die default Konfiguration zurückgesetzt. Das bedeutet die runlevels 2,3,4 und 5 sind wieder aktiviert.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b5.png}
\end{center}
\caption[Abbildung 5: chkconfig iptables on | off]{chkconfig iptables on | off}
\end{figure}

6)\# chkconfig tftp on \\
Tftp ist ein Vorgänger des FTP-Protokolls. Dieser service ist nicht automatisch auf Centos-6.5-x86\_64 vorinstalliert und wird durch den Superserver xinetd, welcher ebenfalls nicht automatisch vorinstalliert ist, verwaltet. Damit wir die gewissen Pakete mit allen Abhängigkeiten für tftp und xinetd über das Terminal mit yum (Yellow dog Updater, Modified) installieren können, müssen wir ein Quellpaket Repository einrichten. \\ Zuerst erstellen wir einen Ordner mit \# mkdir /dvdrom im Verzeichnis /etc/yum.repos.d \\ Danach fügen wir das Verzeichnis als neues Repository hinzu, indem wir die Konfigurationsdatei mit dem vi Editor öffnen \# vi /etc/yum.repos.d/local.repo und das Repository hinzufügen. [Abb. 6]
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_1.png}
\end{center}
\caption[Abbildung 6: vi /etc/yum.repos.d/local.repo]{vi /etc/yum.repos.d/local.repo}
\end{figure}
Zuletzt mounten wir das Verzeichnis mit dem Befehl \# mount -t iso9660/dev/sr0/dvdrom
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_2.png}
\end{center}
\caption[Abbildung 7: mounten]{mounten}
\end{figure}
Nach dem wir den Befehl \#yum clean all im Terminal ausgeführt haben, kann die Installation beginnen. Dies geschieht wie folgt: \\ Wir führen im Terminal den Befehl \#yum install tftp aus, sodass die Installation starten kann.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_3.png}
\end{center}
\caption[Abbildung 8: yum install tftp]{yum install tftp}
\end{figure}
Nachdem tftp installiert wurde, muss außerdem xinetd installiert werden. Ansonsten kann tftp nicht verwendet werden. Mit dem Befehl \#yum install xinetd wird xinetd installiert.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_4.png}
\end{center}
\caption[Abbildung 9: yum install tftp]{yum install xinetd}
\end{figure}
Zunächst muss xinetd gestartet werden, damit wir Zugriff auf tftp haben. Dies geschieht mit dem Befehl \# service xinetd start.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_5.png}
\end{center}
\caption[Abbildung 10: service xinetd start]{service xinetd start}
\end{figure}
Die Dateien im Verzeichnis /etc/xinetd.d/ enthalten die Konfigurationsdateien für jeden von xinetd verwalteten Dienst. Die Konfigurationsdatei tftp muss wie in Abbildung 15 angepasst werden. Damit tftp funktioniert, muss disable=no sein. Disable legt fest, ob der Dienst aktiv ist oder nicht. Im Regelfall ist "disable = yes" zu Beginn. Dieser muss dann geändert werden zu "diasable = no". Nach der Konfiguration kann tftp genutzt werden, wie in Abbildung 12 zu sehen ist.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_6.png}
\end{center}
\caption[Abbildung 11: ]{}
\end{figure}
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_7.png}
\end{center}
\caption[Abbildung 12: ]{}
\end{figure}
Nachdem der Befehl \# chkconfig tftp on ausgeführt wurde, kann man sich mit dem Befehl \#chkconfig anzeigenlassen, ob der Dienst wirklich aktiviert wurde, da dieser angibt welche Dienste in ihren jeweiligen runlevels aktiviert bzw. deaktiviert sind. In der Abbildung 13 sieht man, dass tftp aktiviert ist. Tftp findet man unten im Bild bei den "xinetd based services".
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b6_8.png}
\end{center}
\caption[Abbildung 13: ]{}
\end{figure}
7)\# \verb|chkconfig --level 2 vsftpd off| \\ Um diesen Befehl ausführen zu können, muss zunächst vsftpd installiert werden. Dies geschieht mit dem Befehl \# yum install vsftpd. Nach der erfolgreichen Installation kann vsftpd verwendet werden. 
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b7.png}
\end{center}
\caption[Abbildung 14: yum install vsftpd]{yum install vsftpd}
\end{figure}
Mit dem Befehl \#\verb|chkconfig --level 2 vsftpd off| wird der Runlevel 2 von vsftpd deaktiviert.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b7_2.png}
\end{center}
\caption[Abbildung 15: Runlevel 2 von vsftpd wird deaktiviert]{Runlevel 2 von vsftpd wird deaktiviert}
\end{figure}
8)\# \verb|chkconfig --level 2345 vsftpd off| \\
Mit dem Befehl \#  \verb|chkconfig --level 2345 vsftpd off| werden die Runlevels 2, 3, 4 und 5 deaktiviert.\\
Zunächst haben wir mit dem Befehl "\#  \verb|chkconfig --level 2345 vsftpd|"die Runlevels 2, 3, 4 und 5 aktiviert, wie in Abbildung 16 zu sehen ist.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b8_1.png}
\end{center}
\caption[Abbildung 16: ]{}
\end{figure}

Hier sieht man, dass nach der Aktivierung die entsprechenden Runlevels aktiviert wurden.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b8_2.png}
\end{center}
\caption[Abbildung 17: ]{}
\end{figure}

Anschließend werden mit dem Befehl "\#  \verb|chkconfig --level 2345 vsftpd off|" die Runlevels 2, 3, 4 und 5 deaktiviert.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b8_3.png}
\end{center}
\caption[Abbildung 18: ]{}
\end{figure}

Man erkennt, dass die aktivierten Runlevels nach dem Ausführen des Befehls ausgeschaltet wurden.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b8_4.png}
\end{center}
\caption[Abbildung 19: ]{}
\end{figure}
9)\# Explain the function of xinetd \\
Bei xinetd handelt es sich um einen open source Superserver für Unix-Systeme. Dieser verwaltet verschiedene Dienste u.a. den FTP / HTTP Server. \\Xinetd bietet gegenüber dem Vorgänger inetd noch weitere zusätzliche Dienste an um eine verbesserte Sicherheit zu ermöglichen. Dazu zählen Zugangskontrollen, zeitliche Beschränkung von Diensten (nach Datum und Uhrzeit), sowie einen Verteidigungsmechanismus gegen Portscanner. Sobald der xinetd Superserver eingeschaltet ist, lässt sich im Terminal nachvollziehen, welche Dienste über xinetd verwaltet werden.\\
The super server xinetd controlled services are automatically enabled or disabled by chkconfig. \\
Please type and explain the meaning of the following commands: \\
10)\# service network stop\\
Der command stoppt alle konfigurierten Netzwerk interfaces.
11)\# service network start\\ Der command aktiviert alle konfigurierten Netzwerk interfaces. 
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_3/b10.png}
\end{center}
\caption[Abbildung 20: ]{}
\end{figure}

\section*{Exercise 7: Configure the following network (figure 1) using ifconfig and route add}
\addcontentsline{toc}{section}{Exercise 7: Configure the following network (figure 1) using ifconfig and route add} 
You need to set the network depicted on figure 1 by doing the following: \\
Use the \dq ifconfig\dq and the \dq route add\dq commands to configure all the subnets 10.88.X.32/27, 10.88.X.64/27, 10.88.X.96/27 and 10.88.X.128/27. For this exercise you will use the hosts pnidX-svr-mu, pnidX-WEB-hn, pnidX-svr-bln and pnidX-svr-hh. Furthermore you have to configure the routers pnidX-rou-1, pnidX-rou-2 and pnidX-rou-3 \\
Hint 1: Remember after rebooting the system, the ifconfig and route add configuration will disappear\\
Hint 2: Do not forget to flush the firewall by issuing the command \dq iptables -F\dq \\
Please use Kali Linux as root:\\
\# zenmap\\
Scan the networks: \\
10.88.X.32/27 \\
10.88.X.64/27 \\
10.88.X.96/27 \\
and 10.88.X.128/27 \\\\
Ziel der Aufgaben 7, 8 und 9 ist, das folgende Netzwerk [Abb. 21] mithilfe verschiedener Kommandos aufzubauen um alle zugehörigen Subnetze zu konfigurieren. 
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b1.png}
\end{center}
\caption[Abbildung 21: ]{}
\end{figure}
Zunächst haben wir das Netzwerk für den pnid4-svr-mu (Sever München) konfiguriert, indem wir die Ethernetkarte eth0 zustehende Adresse 10.88.40.129 zugewiesen haben und die Netmask-Adresse mit einbinden. Dieses haben wir ermöglicht, indem wir /27 im Anschluss hinzugefügt haben, jedoch ist es auch über dem Schlüsselwort netmask und die komplette Adresse realisierbar. \\
Anschließend haben wir die Routing tables über dem Kommando route add erstellt. Hier haben wir die Netze 10.88.40.96, 10.88.40.64 und 10.88.40.32 mit dem Kommando versehen, da wir über alle drei Netze eine Verbindung herstellen möchten. \\
Nachstehend haben wir die Firewall dieses Servers ausgeschaltet, da wir später eine Verbindung mit anderen Servern und Routern aufbauen möchten. Wir haben die ganze Konfiguration in einer txt-Datei geschrieben und im Anschluss einmal ausgeführt, sodass wir die Konfiguration gespeichert haben und nicht bei jedem Shut-Down erneut einstellen müssen. \\
\textbf{Konfigurationsdatei von Server-München:(Routing-Tabelle)} \\
ifconfig eth0 weißt der Netzwerkkarte die zugehörige IP-Adresse zu. \\ Mit dem Befehl route add werden statische Routen zu Rechnern und Netzwerken festgeleget.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b2.png}
\end{center}
\caption[Abbildung 22: ]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b3.png}
\end{center}
\caption[Abbildung 23: ]{}
\end{figure}

\textbf{Konfigurationsdatei von WEB-Hannover:(Routing-Tabelle)} \\
ifconfig ens33 weißt der Netzwerkkarte die zugehörige IP-Adresse zu. \\ Mit dem Befehl route add werden statische Routen zu Rechnern und Netzwerken festgeleget.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b4.png}
\end{center}
\caption[Abbildung 24: ]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b5.png}
\end{center}
\caption[Abbildung 25: ]{}
\end{figure}

\textbf{Konfigurationsdatei von Server-Berlin:(Routing-Tabelle)} \\
ifconfig ens33 weißt der Netzwerkkarte die zugehörige IP-Adresse zu. \\ Mit dem Befehl route add werden statische Routen zu Rechnern und Netzwerken festgeleget.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b6.png}
\end{center}
\caption[Abbildung 26: ]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b7.png}
\end{center}
\caption[Abbildung 27: ]{}
\end{figure}

\textbf{Konfigurationsdatei von Server-Hamburg:(Routing-Tabelle)} \\
ifconfig ens33 weißt der Netzwerkkarte die zugehörige IP-Adresse zu. \\ Mit dem Befehl route add werden statische Routen zu Rechnern und Netzwerken festgeleget.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b8.png}
\end{center}
\caption[Abbildung 28: ]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b9.png}
\end{center}
\caption[Abbildung 29: ]{}
\end{figure}

\textbf{Konfigurationsdatei von Router 1:(Routing-Tabelle)} \\
Wie in folgenden Ausschnitten zusehen ist haben wir die Router ebenfalls, so wie oben beschrieben, konfiguriert. Allerdings haben wir hier zwei Ethernet-Anbindungen. Denn ein Router hat immer eine Verbindung zwischen mindestens zwei Netzwerken und leitet Datenpakete anhand von Information der IP-Adressen zwischen den Netzwerken weiter. \\
Mit ifconfig ens33 und ens37 weißt man den Netzwerkkarten die zugehörige IP-Adresse zu. \\ Mit dem Befehl route add werden statische Routen zu Rechnern und Netzwerken festgeleget.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b10.png}
\end{center}
\caption[Abbildung 30: ]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b11.png}
\end{center}
\caption[Abbildung 31: ]{}
\end{figure}

\textbf{Konfigurationsdatei von Router 2:(Routing-Tabelle)} \\
Mit ifconfig ens33 und ens37 weißt man den Netzwerkkarten die zugehörige IP-Adresse zu. \\ Mit dem Befehl route add werden statische Routen zu Rechnern und Netzwerken festgeleget.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b12.png}
\end{center}
\caption[Abbildung 32: ]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b13.png}
\end{center}
\caption[Abbildung 33: ]{}
\end{figure}

\textbf{Konfigurationsdatei von Router 3:(Routing-Tabelle)} \\
Mit ifconfig ens33 und ens37 weißt man den Netzwerkkarten die zugehörige IP-Adresse zu. \\ Mit dem Befehl route add werden statische Routen zu Rechnern und Netzwerken festgeleget.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b14.png}
\end{center}
\caption[Abbildung 34: ]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b15.png}
\end{center}
\caption[Abbildung 35: ]{}
\end{figure}
Please use Kali Linux as root:
\# zenmap\\
Scan the networks:\\
10.88.X.32/27\\
10.88.X.64/27\\
10.88.X.96/27\\
and 10.88.X.128/27\\
\textbf{Zenmap}\\
Zenmap ist eine grafische Ansicht für Nmap, der Ports scannen kann. Wenn man einen Rechner auf offene Ports checken möchte, dann kommt Nmap zum Einsatz. Der Network Mapper ist dafür da, um alle aktiven Hosts in der Netzwerkumgebung (über Ping) sowie deren Betriebssystem und Versionsnummern installierter Dienste herauszufinden. \\
Infolgedessen konnten wir mit dem Kommando zenmap die Verbindungen von Netzwerk 10.88.40.32, 10.88.40.64, 10.88.40.96 und 10.88.40.128 grafisch darstellen und demonstrieren, dass wir die oben aufgeführte Abbildung und somit unser Ziel erreicht haben.
\begin{center}
Das Netz 10.88.40.32/27 wird gescannt:
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b16.png}
\end{center}
\caption[Abbildung 36: Netz: 10.88.40.32/27]{Netz: 10.88.40.32/27}
\end{figure}
\begin{center}

Das Netz 10.88.40.64/27 wird gescannt:
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b17.png}
\end{center}
\caption[Abbildung 37: Netz: 10.88.40.64/27]{Netz: 10.88.40.64/27}
\end{figure}

\begin{center}
Das Netz 10.88.40.96/27 wird gescannt:
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b18.png}
\end{center}
\caption[Abbildung 38: Netz: 10.88.40.96/27]{Netz: 10.88.40.96/27}
\end{figure}

\begin{center}
Das Netz 10.88.40.128/27 wird gescannt:
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_7/b19.png}
\end{center}
\caption[Abbildung 39: Netz: 10.88.40.128/27]{Netz: 10.88.40.128/27}
\end{figure}

\section*{Exercise 8: Configure the following network (figure 1) using ip and nmcli}
\addcontentsline{toc}{section}{Exercise 8: Configure the following network (figure 1) using ip and nmcli} 

You need to set the network depicted on figure 1 by doing the following: \\

Use the ?ifconfig? and the ?route add? commands to configure all the subnets 10.88.X.32/27, 10.88.X.64/27, 10.88.X.96/27 and 10.88.X.128/27. For this exercise you will use the hosts pnidX-svr-mu, pnidX-WEB-hn, pnidX-svr-bln and pnidX-svr-hh. Furthermore you have to configure the routers pnidX-rou-1, pnidX-rou-2 and pnidX- rou-3 \\

\textbf{Hint 1:} Remember after rebooting the system, the ifconfig and route add configuration will disappear \\

\textbf{Hint 2:} Do not forget to flush the firewall by issuing the command iptables -F \\

\textbf{Please use Kali Linux as root:} \\ 
\textbf{\# zenmap} \\
\textbf{Scan the networks:}  \\
10.88.X.32/27 \\
10.88.X.64/27  \\
10.88.X.96/27\\
10.88.X.128/27\\

\textbf{Einleitung:} \\

In dieser Aufgabe geht es darum das Netzwerk mittels ip und nmcli zu konfigurieren. Ip ist die neuere Version des Kommandozeilenprogramms von ifconfig. Demzufolge ist Sie leistungsfähiger und wird irgendwann ifconfig ersetzen. Man muss sich nur mit der Syntax vertraut machen. In den nächsten Schritten wird gezeigt, wie man mittels ip die Netze konfiguriert. In dieser Aufgabe gehen wir vom Aufbau her wie in Exercise 7 vor. Deswegen betrachten wir der übersichtshalber nur die vi-Datei, die entsprechend angepasst werden muss.\\

\textbf{Vergleich von Nmcli und IP:} \\

Nmcli auch bekannt als Network Manager hat viele Vorteile gegenüber anderen Verfahren, insbesondere bei einer WLAN-Verbindung. Denn Nmcli regelt die Verbindung zum Netzwerk nicht ausschließlich beim Hochfahren, sondern überwacht auch im Laufe eines Betriebes die Verbindung und wenn nötig stellt nmcli die Verbindung nach Unterbrechungen wieder her. Deswegen ist der Network Manager auch für Server-Installationen interessant, quasi als Ersatz für die Netzwerkkonfiguration. Auch bei der Fehlersuche spielt nmcli eine bedeutende Rolle.
Die Möglichkeiten von nmcli und die dabei zu verwendende Kommandosprache sind versionsabhängig. Zunächst betrachten wir die für CentOS 7 verwendete Kommandosprache. \\

Ähnlich wie bei ip wird zunächst die IP-Adresse festgelegt. Dies geschieht mit dem Befehl nmcli con add con-name mit dem jeweiligen Namen der Netzwerkkarte. In diesem Fall ist es ens33 mit dem Typen type ethernet ifname, wie man der Abbildung 48 entnehmen kann. Anschließend folgt die IP-Adresse in Version 4. Deswegen schreibt man ip4 und direkt danach die dazugehörige IP-Adresse mit der entsprechenden Subnetzmaske. In diesem Fall wieder 255.255.255.224 und vereinfacht dargestellt als /27 direkt hinter der IP-Adresse.\\

Die nächsten Zeilen legen fest, durch welches Gateway ein Datenpaket weitergeleitet werden soll, wenn es nicht im entsprechenden Subnetz ist, sprich wenn die Netzadresse nicht dieselbe ist. Der Befehl nmcli connection modify dient dazu die entsprechenden Routen zu bestimmen. Im Anschluss steht der Name der Netzwerkkarte. Der Befehl +ipv4.routes sorgt dafür, dass das entsprechende Subnetz angegeben wird, in das geroutet werden soll. Dafür muss man noch das jeweilige Gateway angeben, durch welches man in das entsprechende Subnetz gelangt. Dies geschieht mittels ipv4.gateway. Am Ende wird noch mit dem Befehl iptables -F die Firewall ausgeschaltet.  \\

\textbf{Konfigurationsdatei von Server München mittles ip addr (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/1svrmuip.png}
\end{center}
\caption[Abbildung 39: Konfig. Server München mit ip addr]{Konfig. Server München ip addr}
\end{figure}

\textbf{Konfigurationsdatei von Router 3 mittels ip addr (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/2rou3ip.png}
\end{center}
\caption[Abbildung 39: Konfig. Router 3 mit ip addr]{Konfig. Router 3 ip addr}
\end{figure}

\textbf{Gleiche Konfigurationsdatei von Router 3 mittels nmcli (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/2rou3nmcli.png}
\end{center}
\caption[Abbildung 39: Konfig. Router 3 mit nmcli]{Konfig. Router 3 nmcli}
\end{figure}

Nach dem Ausführen des Skriptes wurden die Verbindungen ens33 und ens37 erfolgreich hinzugefügt. Mit nmcli con up wird die Verbindung aktiviert und anschließend wird über netstat -nr die Routing-Tabelle angezeigt.

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/2rou3routingTabelle.png}
\end{center}

\textbf{Konfigurationsdatei von Router 2 mittels ip addr (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/3rou2ip.png}
\end{center}
\caption[Abbildung 39: Konfig. Router 2 mit ip addr]{Konfig. Router 2 ip addr}
\end{figure}

\textbf{Gleiche Konfigurationsdatei von Router 2 mittels nmcli (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/3rou2nmcli.png}
\end{center}
\caption[Abbildung 39: Konfig. Router 2 mit nmcli]{Konfig. Router 2 nmcli}
\end{figure}

\textbf{Konfigurationsdatei von Router 1 mittels ip addr (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/4rou1ip.png}
\end{center}
\caption[Abbildung 39: Konfig. Router 1 mit ip addr]{Konfig. Router 1 ip addr}
\end{figure}

\textbf{Gleiche Konfigurationsdatei von Router 1 mittels nmcli (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/4rou1nmcli.png}
\end{center}
\caption[Abbildung 39: Konfig. Router 1 mit nmcli]{Konfig. Router 1 nmcli}
\end{figure}

\textbf{Konfigurationsdatei von Webserver Hannover mittels ip addr (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/5webhnip.png}
\end{center}
\caption[Abbildung 39: Konfig. Webserver Hannover mit ip addr]{Konfig.  Webserver Hannover ip addr}
\end{figure}

\textbf{Konfigurationsdatei von Server Berlin mittels nmcli (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/6svrblnnmcli.png}
\end{center}
\caption[Abbildung 39: Konfig. Server Berlin mit nmcli]{Konfig.  Server Berlin nmcli}
\end{figure}

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/6svrblnroutingTabelle.png}
\end{center}

\textbf{Konfigurationsdatei von Server Hamburg mittels ip addr (Routing-Tabelle)}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/7svrhhip.png}
\end{center}
\caption[Abbildung 39: Konfig. Server Hamburg mit ip addr]{Konfig. Server Hamburg ip addr}
\end{figure}

\textbf{Zenmap Ergebnisse der gescannten Subnetze: }

\begin{center}
Scan des Subnetztes 10.88.40.32/27
\end{center}

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/zenmap/z32.png}
\end{center}

\begin{center}
Scan des Subnetztes 10.88.40.64/27
\end{center}

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/zenmap/z64.png}
\end{center}

\begin{center}
Scan des Subnetztes 10.88.40.96/27
\end{center}

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/zenmap/z96.png}
\end{center}

\begin{center}
Scan des Subnetztes 10.88.40.128/27
\end{center}

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_8/zenmap/z128.png}
\end{center}

\section*{Exercise 9: Configure the following network (figure 1) using GUI}
\addcontentsline{toc}{section}{Exercise 9: Configure the following network (figure 1) using GUI} 

Damit die Konfiguration problemlos gelingen kann, sollte auf jedem Host, im Terminal, mit dem Kommando iptables -F die Firewall deaktiviert werden.

\textbf{Konfiguration von Server München über die GUI:} \\

Wir starten die Netzwerkkonfiguration auf dem Host pnid4-svr-mu mit dem Betriebssystem Centos 6. Zunächst gehen wir im Auswahlmenü auf System -> Preferences und wählen Network Connections aus.

\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_3/exercise_9/svr-mu/1.png}
\end{center}

Es öffnet sich ein Fenster in der wir die Bezeichner alle verfügbaren Netzwerk Interfaces sehen. Wir Wählen Auto eth3 aus und bestätigen mit Edit. Mit Add lässt sich ein neues Interface einrichten. 

\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_3/exercise_9/svr-mu/2.png}
\end{center}

Wir können nun unser bereits vorhandenes Netzwerk Interface Auto eth3 bearbeiten. Dazu Wählen wir in der Navigation IPv4 Settings aus und erhalten folgende Ansicht. Falls Auto ausgewählt ist, ändern wie dieses auf Manual, damit wir eine statische IP Adresse eintragen können. Wir können im Bereich Addresses mit Add eine statische IPv4 Adresse für den Host eintragen. Da wir auf pnid4-svr-mu, vergeben wir die Adresse 10.88.40.129 mit der Subnetzmaske 255.255.255.224. Zuletzt müssen wir noch die jeweiligen Subnetze Eintragen und das Gateway über das wir die anderen Hosts erreichen. Dazu bestätigen wir den Button Routes.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-mu/3.png}
\end{center}

Der Button Routes, öffnet ein neues Fenster. Mit Add können wir nun die Subnetze, dessen Subnetzmaske und das Gateway unseres Edge Routers (Router 3) eintragen. Da wir von pnid4-svr-mu über Router 3 alle anderen Subnetze erreichen können ist das Gateway für alle Subnetze gleich und lautet 10.88.40.130. Abschließend bestätigen wir mit OK.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-mu/4.png}
\end{center}

Damit alle Änderungen für diesen Host übernommen werden bestätigen wir noch mal mit Apply.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-mu/5.png}
\end{center}

Das Netzwerk ist für den Host pnid4-svr-mu nun erfolgreich eingerichtet.

\textbf{Konfiguration von Router 3 über die GUI:}

Router 1, 2 und 3 laufen mit dem Betriebssystem Linux Centos 7. Dementsprechend ist die Netzwerkkonfiguration auf allen Routern die gleiche. Wir erläutern die Konfiguration von Router 3 ausführlich und zeigen dann, welche IP Adressen Router 2 und Router 1 besitzen.

Wir Wählen zuerst unter dem Menüpunkt Anwendungen -> Systemsteuerung die Option Einstellungen aus. Im Auswahlmenü der Systemsteuerung wählen wir Netzwerk aus. Wir erhalten nun eine Netzwerkansicht bei der wir alle Netzwerk Interfaces ansehen können. Zurzeit existieren die Interfaces ens37 und ens33, da wir sie bereits beim Kopieren des Betriebssystems in der VMware Workstation festgelegt haben.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou3/3.png}
\end{center}

Mit dem Einstellungssymbol können wir die Schnittstellen konfigurieren. Wir wählen also ens37 aus und bestätigen mit Einstellungssymbol. Danach Navigieren wir an der linken Seite zu dem Namen IPv4. Falls noch nicht ausgewählt, stellen wir Adressen auf Manuell, damit wir eine statische IP Adresse vergeben können. Nun tragen wir die IP Adresse für die erste Schnittstelle des Routers ein. Als Gateway wählen wir 0.0.0.0 aus.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou3/4.png}
\end{center}

In der gleichen Ansicht wie zuvor scrollen wir etwas runter bis zum Abschnitt Routen und tragen nun die Adressen der Subnetze, die Subnetzmaske und das Gateway, über welches wir die Subnetze erreichen können, ein. Zuletzt bestätigen wir die Konfiguration mit Anwenden.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou3/5.png}
\end{center}

Damit haben wir das Interface mit dem Namen ens37 konfiguriert und müssen uns der zweiten Schnittstelle ens33 zuwenden. Wie eben können wir das Interface über den Button mit dem Einstellungssymbol konfigurieren.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou3/6.png}
\end{center}

Dieses Mal tragen wir die zweite statische IP Adresse für die zweite Schnittstelle ens33 ein.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou3/7.png}
\end{center}

Analog zum vorherigen Schritt scrollen wir runter und tragen die IP Adressen für die Subnetze, Subnetzmasken und das Gateway ein. Die Subnetze, Subnetzmasken und das Gateway sind bei ens33 und ens37 absolut identisch.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou3/8.png}
\end{center}

Zuletzt bestätigen wir die Konfiguration mit Anwenden. Der Router mit dem Namen pnid4-rou3 ist jetzt vollständig konfiguriert. Es folgen noch pnid4-rou2 (Router 2) und pnid4-rou1 (Router 1). \\

\textbf{Konfiguration von Router 2 über die GUI:}  \\

Die Konfiguration auf allen Routern ist identisch. Lediglich die IP Adressen und das Routen unterscheidet sich, deshalb zeigen wir von nun an jeweils die Vergabe der statischen IP Adressen. \\

IP Adresse für das Interface ens37 festlegen: \\

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou2/1.png}
\end{center}

Adressen für die Subnetze festlegen und das jeweilige Gateway einstellen. Zuletzt mit Anwenden bestätigen.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou2/2.png}
\end{center}

IP Adresse für das Interface ens33 festlegen: \\

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou2/3.png}
\end{center}

Adressen für die Subnetze festlegen und das jeweilige Gateway einstellen. Zuletzt mit Anwenden bestätigen.

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/rou2/4.png}
\end{center}

Damit ist die Konfiguration von Router 1 abgeschlossen. \\

\textbf{Konfiguration von Webserver Hannover über die GUI:}  \\

Dieser Host hat ebenfalls Linux Centos 7 als Betriebssystem, deshalb sind die Konfigurationsschritte dieselben wie bei den Routern. \\

IP Adresse für das Interface ens33 festlegen: \\

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/WEB-hn/1.png}
\end{center}

Adressen für die Subnetze festlegen, das jeweilige Gateway einstellen und die Routen eintragen. 

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/WEB-hn/2.png}
\end{center}

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/WEB-hn/3.png}
\end{center}

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/WEB-hn/4.png}
\end{center}

Zuletzt mit Anwenden bestätigen. Damit ist auch der Host pnid4-WEB-hn vollständig für die Subnetze konfiguriert. \\

\textbf{Konfiguration von Server Berlin über die GUI:}  \\

IP Adresse für das Interface ens33 festlegen: \\

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-bln/1.png}
\end{center}

Adressen für die Subnetze festlegen, das jeweilige Gateway einstellen und die Routen eintragen. 

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-bln/2.png}
\end{center}

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-bln/3.png}
\end{center}

Zuletzt mit Anwenden bestätigen. Damit ist auch der Host pnid4-svr-bln vollständig für die Subnetze konfiguriert. \\

\textbf{Konfiguration von Server Hamburg über die GUI:}  \\

IP Adresse für das Interface ens33 festlegen: \\

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-hh/1.png}
\end{center}

Adressen für die Subnetze festlegen, das jeweilige Gateway einstellen und die Routen eintragen. 

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-hh/2.png}
\end{center}

\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_3/exercise_9/svr-hh/3.png}
\end{center}

Zuletzt mit Anwenden bestätigen. Damit ist auch der Host pnid4-svr-hh vollständig für die Subnetze konfiguriert. \\

\textbf{Zenmap Ergebnisse der gescannten Subnetze über die GUI: } \\

Alle Hosts sind jetzt in ihren jeweiligen Subnetzen konfiguriert. Um einen Visuellen überblick über die Netzwerktopologie der einzelnen Subnetze zu erhalten, können wir mithilfe der Zenmap die einzelnen Netzwerke scannen. Dazu melden wir uns auf dem Host mit dem Betriebssystem Kali Linux an, welcher die IP Adresse 10.88.40.69/27 hält und geben in das Terminal den Befehl \# zenmap ein.\\

\textbf{Scan des Subnetztes 10.88.40.64/27}\\

In der Suchleiste Target können wir nun die IP Adresse des Subnetzes eingeben, welchen wir scannen möchten. Wir starten mit dem Subnetz 10.88.40.128 und bestätigen den Vorgang mit Scan.

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_9/zenmap/n128.png}
\end{center}

\textbf{Scan des Subnetztes 10.88.40.96/27}\\

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_9/zenmap/n96.png}
\end{center}

\textbf{Scan des Subnetztes 10.88.40.64/27}\\

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_9/zenmap/n64.png}
\end{center}

\textbf{Scan des Subnetztes 10.88.40.32/27}\\

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_3/exercise_9/zenmap/n32.png}
\end{center}





\chapter*{Part 4: Network Scanning}
\addcontentsline{toc}{chapter}{Part 4: Network Scanning} 

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.2\textwidth]{bilder/screens/Part_4/lan.PNG} 
\end{center}
\caption[Abbildung P4 figure 1 LAN]{Netzwerk mit allen Hosts und Subnetzen}
\end{figure}

\section*{Exercise 1: Configure the networks of figure 1}
\addcontentsline{toc}{section}{Exercise 1: Configure the networks of figure 1} 

\textbf{a)} Please copy, configure and set the networks for the following virtual machines provided by your instructor:\\
vm-Debian-8.5 copy from USB provided , \\
vm-Ubuntu-16-10 copy from USB provided. \\ 
The password for the virtual machines is hamburg99tkrn for Ubuntu and Debian. \\ \\
\textbf{b)} Please scan the following networks: 10.88.X.64/27, 10.88.X.96/27, 10.88.X.128/27, 10.88.X.160/27 and 10.88.X.32/27 \\ \\
\textbf{c)} Use Zenmap to scan all the above networks \\

Zenmap liefert uns alle statisch vergebenen IP Adressen der Hosts. Als Zusatz erhalten wir die Netzwerktopologie, ausgehend von dem aktuellen Host.  \\

\textbf{Solution of b)}

\begin{center}
Scan des Subnetztes 10.88.40.64/27
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.55\textwidth]{bilder/screens/Part_4/Exercise_1/z64.PNG} 
\end{center}
\caption[Abbildung P5 ex. 1 Zenmap Subnetz 64]{Subnetz 10.88.40.64/27}
\end{figure}

\begin{center}
Scan des Subnetztes 10.88.40.96/27
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.55\textwidth]{bilder/screens/Part_4/Exercise_1/z96.PNG} 
\end{center}
\caption[Abbildung P5 ex. 1 Zenmap Subnetz 96]{Subnetz 10.88.40.96/27}
\end{figure}

\begin{center}
Scan des Subnetztes 10.88.40.128/27
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.55\textwidth]{bilder/screens/Part_4/Exercise_1/z128.PNG} 
\end{center}
\caption[Abbildung P5 ex. 1 Zenmap Subnetz 128]{Subnetz 10.88.40.128/27}
\end{figure}

\begin{center}
Scan des Subnetztes 10.88.40.160/27
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.55\textwidth]{bilder/screens/Part_4/Exercise_1/z160.PNG} 
\end{center}
\caption[Abbildung P5 ex. 1 Zenmap Subnetz 160]{Subnetz 10.88.40.160/27}
\end{figure}

\begin{center}
Scan des Subnetztes 10.88.40.32/27
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.55\textwidth]{bilder/screens/Part_4/Exercise_1/z32.PNG} 
\end{center}
\caption[Abbildung P5 ex. 1 Zenmap Subnetz 32]{Subnetz 10.88.40.32/27}
\end{figure}

\textbf{Solution of c) Use Zenmap to scan all the above networks}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.55\textwidth]{bilder/screens/Part_4/Exercise_1/zAlle.PNG} 
\end{center}
\caption[Abbildung P5 ex. 1 Zenmap alle Subnetze]{Alle Subnetze}
\end{figure}

Alternativ hätte man als Target auch folgendes in die Eingabemaske einfügen können: 10.88.40.32-160/27

\section*{Exercise 2: NMAP}
\addcontentsline{toc}{section}{Exercise 2: NMAP} 

Analyze your host system and your virtual machines with Nmap. Please test the following commands before explaining the meaning.  \\

Q1: Please type and explain the nmap command: nmap -sS -O 10.88.X.? \\
Q2: Please type and explain the nmap command: nmap -sF 10.88.X.? -oN outfile \\ 
Q3: Please type and explain the nmap command: nmap -sS 10.88.X.? -D 10.100.X.P \\
Q4: Please type and explain the nmap command: nmap -sS -O 10.88.X.Y/Z \\
Q5: Please type and explain the nmap command: nmap -sP -PS 10.88.X.? \\
Q6: Please type and explain the nmap command: nmap -sP -PS25 10.88.X.?  \\
Q7: Please type and explain the nmap command: nmap -sP -PS80 10.88.X.?/Z  \\
Q8: Please type and explain the nmap command: nmap -sP -PS53 10.88.X.?/27  \\
Q9: Please type and explain the nmap command: nmap -sS -v 10.88.X.? \\
Q10: Please type and explain the nmap command: nmap -sP -v 10.88.X.? \\

\textbf{Question 1:}  Please type and explain the nmap command: nmap -sS -O 10.88.X.?  \\

\textbf{Answer 1:} Scannt das Subnetz 10.88.40.128 nach dem Host mit der IP Adresse 10.88.40.130 -sS bedeutet in diesem zusammenhang SYN-Stealth-Scan. Dabei wird keine vollständige TCP/IP Vergindung aufgebaut und ist deshalb unauffäliger als das der Parameter -sT, welcher als einziger ohne root rechte Funktioniert. -O steht für OS-Detection. Es wird Versucht, an besonderen Eigenarten der Netzwerkimplementierungen das Betriebssystem des Zieles zu identifizieren. Im Gegensatz zu Zenmap, wird nmap im Terminal durchgeführt und besitzt keine grafische Benutzeroberfläche um die Netzwerktopologie zu visualisieren. 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.65\textwidth]{bilder/screens/Part_4/Exercise_2/Q1.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 1]{nmap -sS -O 10.88.40.130}
\end{figure}

\textbf{Question 2:} Please type and explain the nmap command: nmap -sF 10.88.X.? -oN outfile \\ 

\textbf{Answer 2:}  Bei diesem Scan wir das Subnetz 10.88.40.128/27 mit dem Argument -sF gescannt. -sF bezeichnet die Art des Scans bei der nur Pakete mit FIN-flags zum Ziel Host gesendet werden. Durch das Argument -oN outfile erstellen wir ein externes Logfile, mit dem Namen outfile.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_4/Exercise_2/Q2/Q21.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 2]{nmap -sF 10.88.40.128 -oN outfile}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_4/Exercise_2/Q2/Q23.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap externes Logfile]{externes Logfile}
\end{figure}

Mit dem Befehl  -sF werden die Ports, die gescannt werden manipuliert, in dem verfälschte TCP-Pakete versendet werden. Dadruch erhält man die Information, ob ein Port offen oder von einer Firewall geschützt ist.  Die Ausgabe wird im Terminal angezeigt, sowie durch das Argument -oN outfile, in einer seperaten outfilele.txt Datei. \\

\textbf{Question 3:} Please type and explain the nmap command: Please type and explain the nmap command: nmap -sS 10.88.X.? -D 10.100.X.P \\ 

\textbf{Answer 3:} Dieser Befehlt führt einen Decoy-Scan durch. Mit dem Argument -D 10.88.40.36 legen wir einen Köder aus, mit dem wir den Ziel Host / Subnetz scannen. Diese Methode wird verwendet um die eigene IP Adresse zu verbergen, jedoch sollte der Host, welcher als Köder benutzt wird eingeschaltet sein.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_4/Exercise_2/Q3.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 3]{nmap -sS 10.88.40.130 -D 10.88.40.36}
\end{figure}

\textbf{Question 4:} Please type and explain the nmap command: nmap -sS -O 10.88.X.Y/Z \\ 

\textbf{Answer 4:} Der Befehl versucht alle erreichbaren Hosts im Netzwerk X, mit ihrer IP Adresse anzuzuzeigen. Zusätzlich wird -sS (SYN-Stealth-Scan) und -O (OS-Detection) verwendet.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_4/Exercise_2/Q4.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 4]{nmap -sS -O 10.88.40.160/27}
\end{figure}

\textbf{Question 5:} Please type and explain the nmap command: nmap -sP -PS 10.88.X.?\\ 

\textbf{Answer 5:} Das Argument -sP ist der sogenannte Ping-Scan. Es werden alle Hosts ausgegeben, welche auf den Scan geantwortet haben. So kann die Verfügbarkeit eines Rechners im Netzwerk gezählt werden, sowie die Server-Verfügbarkeit überwacht werden. Das Argument -PS sendet ein leeres TCP-Paket mit gesetzten SYN-Flag. Ein SYN-Flag ist ein Synchronisations-Flag, bestehend aus einem Bit. Ist dieser Flag gesetzt, will der Sender eine Verbindung zum Empfänger aufbauen. 
 
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_2/Q5.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 5]{nmap -sP -PS 10.88.40.130}
\end{figure}

\textbf{Question 6:} Please type and explain the nmap command: nmap -sP -PS25 10.88.X.?\\ 

\textbf{Answer 6:}  Mit dem Argument -sP wird die Ping-Scan Methode ausgewählt.  -PS wird verwendet um SYN-Pakete, mit gesetztem SYN-flag über den Port 25 (SMTP) zu senden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_2/Q6.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 6]{nmap -sP -PS25 10.88.40.130}
\end{figure}

\textbf{Question 7:} Please type and explain the nmap command: nmap -sP -PS80 10.88.X.?/Z\\ 

\textbf{Answer 7:}  Mit dem Argument -sP wird die Ping-Scan Methode ausgewählt.  -PS wird verwendet um SYN-Pakete, mit gesetztem SYN-flag über den Port 80 zu senden.  Port 80 ist zuständig für den Hypertext Transfer Protocol (HTTP). HTTP verwendet das TCP-Protokoll und benutzt diesen am Port 80.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_2/Q7.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 7]{nmap -sP -PS80 10.88.40.130/27}
\end{figure}

\textbf{Question 8:}  Please type and explain the nmap command: nmap -sP -PS53 10.88.X.?/27\\ 

\textbf{Answer 8:}  Hier wird ebenso ein TCP SYN-Scan auf dem Port 53 durchgeführt. Port 53 wird verwendet für das Domain Name System (DNS) und wird meist über UDP verwendet.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_2/Q8.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 8]{nmap -sP -PS53 10.88.40.130/27}
\end{figure}

\textbf{Question 9:}  Please type and explain the nmap command: nmap -sS -v 10.88.X.?\\ 

\textbf{Answer 9:}  -sS-Der SYN-Scan ist eine Methode fürs schnelle Scannen und scannt dabei Tausende von Ports pro Sekunde, wenn es nicht von einer Firewall gestört wird. Der Syn-Scan schließt die TCP-Verbindungen nicht ab. Außerdem kann zwischen den Zuständen offen, geschlossen und gefiltert unterschieden werden. Da keine vollständigen TCP-Verbindungen hergestellt werden, wird dies auch als halboffenes Scannen bezeichnet. Ein SYN-Paket wird gesendet. Dann wird auf eine Antwort gewartet. Ein SYN/ACK gibt an, dass jemand auf dem Port lauscht. Dies ist an einem offenen Port erkennbar. RST jedoch bedeutet, dass der Port geschlossen ist.  -v bedeutet, dass die Ausführlichkeitsstufe erhöht wird(verbosity-Level), um mehr Wirkung zu erzielen.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_2/Q9.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 9]{nmap -sS -v 10.88.40.130}
\end{figure}

\textbf{Question 10:} Please type and explain the nmap command: nmap -sP -v 10.88.X.? \\ 

\textbf{Answer 10:} Ein Ping-Scan wird ausgeführt mit erhöhtem Verbosity Level.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_2/Q10.PNG} 
\end{center}
\caption[Abbildung P4 ex. 2 nmap command 10]{nmap -sP -v 10.88.40.130}
\end{figure}

\section*{Exercise 3: Nessus network device identification}
\addcontentsline{toc}{section}{Exercise 3: Nessus network device identification} 

Nessus is a scanner program. \\

It includes following features: \\
a) It is a vulnerability scanner \\
b) It is a port scanner \\
c) It is a host/device detection program \\
d) It can be used to scan Netbios Servers e.g. Windows Servers and Samba Servers  \\
e) Nessus can be used as a penetrating testing tool\\
f) It is a client-server-system. The server performs the actual scan but it is controlled through the client. Both client and server can be run on the same system\\

In this exercise you will download, install and configure Nessus-6.11.2-es7.x86\_64.rpm (use the RPM from your instructor)
Do the following steps to install and run nessus: \\
g. \# Go to the nessus website and register your product for home feed means free cost \\
https://www.tenable.com/products/nessus/select-your-operating-system\#tos
h. \# rpm -Uvh Nessus-6.11.2-es7.x86\_64.rpm on Centos 7 \\
i. \# After registration open your email and copy the activation code and type your activation key \\
j. Now open a web browser and type the following: https://10.88.X.P:8834/ \\
Enter your login name and password that you enter while installation.
Note: download the user manual to obtain more information or refer to the internet.
Then you will perform a scan on all subnet as below and analyze the result. Exercise: \\

1.) Download Nessus from www.nessus.org (Linux Version Nessus-6.11.2 - es7.x86\_64.rpm) \\
2.) Install the Nessus-6.11.2-es7.x86\_64.rpm Binary on your Centos7 Virtual Machine \\
3.) Register Nessus to obtain the plugins (note: choose the offline method) \\
4.) Install the plugins \\
5.) Perform a host identification of the localhost \\
6.) Please scan the following networks: 10.88.X.64/27, 10.88.X.96/27, 10.88.X.128/27, 10.88.X.160/27 and 10.88.X.32/27 using nessus \\
7.) Perform a network device identification on your subnet 10.88.X.P/27, see figure 1 \\

\textbf{Einleitung:} Nessus ist ein Netzwerk- und Vulnerability Scanner. Unter einem Vulnerability Scanner versteht man Computerprogramme. Diese sind dafür zuständig Zielsysteme auf Sicherheitslücken bzw. Schwachstellen zu untersuchen. Der Scanner hat somit Zugriff auf entsprechende Datenbanken, um Informationen zu Sicherheitsproblemen zu bekommen. Dazu gehören der Einsatz bzw. das Vorhandensein von unsicheren oder nicht benötigten Dienste, Fehler in der Konfiguration bzw. Anwendung von Passwort-und Benutzerrichtlinien sowie offene Ports.\\ 

Nessus beruht auf einem Client-Server-Prinzip. Hierbei wird auf einem Rechner der Nessusserver gestartet und im Anschluss wird eine Verbindung zu anderen Rechnern hergestellt. Sobald der Server gestartet wird, werden die Plug-ins geladen. Diese sind notwendig, da man Sicherheitslücken des Betriebssystems finden kann während des Scanns eines Hostes. Nessus kann als Penetrationstest verwendet werden. Darunter versteht man Sicherheitstests eines Rechners oder von Netzwerken. Dabei wird die Sicherheit der Systembestandteile und Anwendungen eines Netzwerks überprüft. Die Mittel, die dafür verwendet werden sind Methoden, die ein Angreifer verwenden würden, um unautorisiert in das System einzudringen, weshalb dies Penetration bezeichnet wird. Man möchte somit vor Angriffen schützen. \\

\textbf{Solution of 1)} Download Nessus from www.nessus.org (Linux Version Nessus-6.11.2-
es7.x86\_64.rpm) \\

Zunächst geht man zur folgenden Webseite: https://www.tenable.com/products/nessus/select-your-operating-system. \\

Anschließend wird die entsprechende Datei für CentOS 7 runtergeladen. Diese ist: Nessus-6.11.3-es7.x86\_64.rpm. Nach dem Runterladen muss man sich noch registrieren, damit man einen Aktivierungs Code bekommt. Diesen erhält man per Email. Nach dem Herunterladen wird die Binary, wie man unten im Bild sieht, in die virtuelle Maschine reinkopiert. \\

\textbf{Solution of 2)} Install the Nessus-6.11.2-es7.x86\_64.rpm Binary on your Centos7 Virtual Machine \\

Um die Binary zu installieren wird der Befehl: rpm -Uvh /home/hanifka/Schreibtisch/Nessus-6.11.2-es7.x86\_64.rpm  im Terminal ausgeführt.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/install_nessus.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3 installation Nessus]{Installation von Nessus im Terminal}
\end{figure}

Nach erfolgreicher Installation kann Nessus mit folgendem Befehl gestartet warden: /bin/systemctl start nessusd.service. Anschließend wird der Browser geöffnet und man gibt folgenden Link ein: https://localhost.localdomain:8834/, um den Scanner konfigurieren zu können. \\

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus_config.PNG} 
\end{center}

Damit dies funktioniert muss man auf den Button, Ausnahme hinzufügen, klicken. Danach muss man die Sicherheits-Ausnahmeregel bestätigen. Auch auf diesen Button wird geklickt.

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus_config2.PNG} 
\end{center}

Jetzt kann mit der Konfiguration gestartet warden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/3.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3 Konfiguration Nessus]{Nessus Konfiguration Startseite}
\end{figure}

\textbf{Solution of 3)} Register Nessus to obtain the plugins (note: choose the offline method) \\

Damit man sich erfolgreich registrieren kann, wählt man die offline Methode. Dann erhält man einen challenge code, den man fürs weitere Vorgehen benötigen wird.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/4.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Registrierung Nessus]{Nessus Registrierung}
\end{figure}

Im Browser wird nun folgender Tab geöffnet. Hier wird zuerst unser zu eben erzeugter challenge code eingegeben und unten wird der der Aktivierungs Code eingegeben, den man per Email nach der Registrierung erhalten hat. 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/activeKey.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Aktivierung Nessus]{Nessus Aktivierungskey}
\end{figure}

Nach dem Klicken auf Submit erhalten wir unsere Nessus License. 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/activeKey.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  License Nessus]{Nessus License}
\end{figure}

Die Nessus License kopieren wir und fügen diese ein, da sie für die erfolgreiche Registrierung notwendig ist. \\

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/5.PNG} 
\end{center}

Nach dem alles erfolgreich konfiguriert wurde und man sich erfolgreich registriert hat, kann man sich anmelden.

\begin{center}
\includegraphics[width=0.3\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/6.PNG} 
\end{center}

\textbf{Solution of 4)} Install the plugins \\

Um die Plugins zu installieren, laden wir die notwendige Datei all-2.0.tar.gz runter und kopieren diese anschließend in die virtuelle Machine. Dort kann sie wie folgt installiert werden übers Terminal oder manuell über die GUI. \\

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/7.PNG} 
\end{center}

Zunächst melden wir uns bei Nessus an. Unter dem Reiter Software Update können wir über den Button Manual Software Update unsere Datei all-2.0.tar.gz mit den ganzen Plugins reinladen.

\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/8.PNG} 
\end{center}

Hier sieht man, dass die Datei all-2.0.tar.gz ausgewählt wird und anschließend geladen werden kann.

\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/9.PNG} 
\end{center}

\textbf{Solution of 5)} Perform a host identification of the localhost and \textbf{Solution of 6)} Please scan the following networks: 10.88.40.64/27, 10.88.40.96/27, 10.88.40.128/27, 10.88.40.160/27 and 10.88.40.32/27 using nessus \\

Das Netz 10.88.40.32/27 wird gescannt. Wir führen eine Host Discovery durch. Die Scans verlaufen alle sehr schnell.
Unter einer Host-Discovery versteht man Methoden oder Maßnahmen, um die erreichbaren Rechner in einem Netzwerk zu identifizieren. Im Allgemeinen versucht man die Rechner zu ermitteln, die über eine IP-Adresse erreichbar sind. Zuerst versucht man alle Hosts in einem Netzwerk zu identifizieren und danach erfolgt eine differenzierte Untersuchung des entsprechenden Hosts. Dadurch erhält man Informationen über die Hardware, das Betriebssystem, laufende Dienste und offene Ports, welches man als Host-Scan bezeichnet. \\

\textbf{Scan des Subnetzes 10.88.40.32/27:} \\
Wir geben bei Targets das zugehörige Netz an, welches gescannt werden soll. Diesem können wir einen Namen und eine Beschreibung hinzufügen

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/32/s32.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Scan Hosts in Subnetzt 10.88.40.32/27]{Scan des Subnetztes 10.88.40.32/27}
\end{figure}

Hier sieht man alle zugehörigen Netze, die zum Subnetz 10.88.40.32/27 gehören, die durch Host-Discovery ermittelt wurden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/32/s322.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Ergebnis des Scans im Subnetz 10.88.40.32/27]{Alle Hosts im Subnetz 10.88.40.32/27}
\end{figure}

\textbf{Scan des Subnetzes 10.88.40.64/27:} \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/64/s64.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Scan Hosts in Subnetzt 10.88.40.64/27]{Scan des Subnetztes 10.88.40.64/27}
\end{figure}

Hier sieht man alle zugehörigen Netze, die zum Subnetz 10.88.40.64/27 gehören, die durch Host-Discovery ermittelt wurden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/64/s642.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Ergebnis des Scans im Subnetz 10.88.40.64/27]{Alle Hosts im Subnetz 10.88.40.64/27}
\end{figure}

\textbf{Scan des Subnetzes 10.88.40.96/27:} \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/96/s96.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Scan Hosts in Subnetzt 10.88.40.96/27]{Scan des Subnetztes 10.88.40.96/27}
\end{figure}

Hier sieht man alle zugehörigen Netze, die zum Subnetz 10.88.40.96/27 gehören, die durch Host-Discovery ermittelt wurden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/96/s962.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Ergebnis des Scans im Subnetz 10.88.40.96/27]{Alle Hosts im Subnetz 10.88.40.96/27}
\end{figure}

\textbf{Scan des Subnetzes 10.88.40.128/27:} \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/128/s128.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Scan Hosts in Subnetzt 10.88.40.128/27]{Scan des Subnetztes 10.88.40.128/27}
\end{figure}

Hier sieht man alle zugehörigen Netze, die zum Subnetz 10.88.40.128/27 gehören, die durch Host-Discovery ermittelt wurden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/128/s1282.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Ergebnis des Scans im Subnetz 10.88.40.128/27]{Alle Hosts im Subnetz 10.88.40.128/27}
\end{figure}

\textbf{Scan des Subnetzes 10.88.40.160/27:} \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/160/s160.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Scan Hosts in Subnetzt 10.88.40.160/27]{Scan des Subnetztes 10.88.40.160/27}
\end{figure}

Hier sieht man alle zugehörigen Netze, die zum Subnetz 10.88.40.160/27 gehören, die durch Host-Discovery ermittelt wurden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/160/s1602.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Ergebnis des Scans im Subnetz 10.88.40.160/27]{Alle Hosts im Subnetz 10.88.40.160/27}
\end{figure}

\textbf{Alle Subnetze:} \\
Im folgenden Bild wurden alle Subnetze gescannt, nämlich 10.88.40.64/27, 10.88.40.96/27, 10.88.40.128/27, 10.88.40.160/27 und 10.88.40.32/27.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/nessus/alle_Subnetze.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3  Ergebnis des Scans aller Subnetze]{Alle Subnetze}
\end{figure}

\textbf{Ergebnis aller Scans:} Die Scans wurden als PDF-Datei extrahiert. Darin stehen alle relevanten Informationen, die über das erfolgreiche Scannen der Host Discovery ermittelt wurden. Die gesamte Datei befindet sich im Anhang der Email. \\

\textbf{Solution of 7)} Perform a network device identification on your subnet 10.88.X.P/27, see figure 1\\

set the ip for this machine to 172.16.15.P, where P stands for the ip address for your reserved ip, see below and change the dns to 134.100.9.61  \\ \\
group 1 will be 172.16.15.13  \\
group 2 will be 172.16.15.23  \\
group 3 will be 172.16.15.33  \\
group 4 will be 172.16.15.43  \\
group 5 will be 172.16.15.53 \\
group 6 will be 172.16.15.63  \\
group 7 will be 172.16.15.73 \\
group 8 will be 172.16.15.83 \\
group 9 will be 172.16.15.93 \\
group 10 will be 172.16.15.103 \\
group 11 will be 172.16.15.113 \\
group 12 will be 172.16.15.123 \\ \\
Please download the installation guide and the user guide and read the Linux section carefully to solve the exercise. \\

\textbf{Solution:} 
Damit wir eine Internetverbindung von einem Hostrechner herstellen können wählen wir zuerst einen Host aus. Wir entschieden uns für pnid4-svr-hh mit dem Betriebssystem Centos 7. Als nächstes öffnen wir auf diesem Host die Netzwerkeinstellungen und fügen ein neue Schnittstelle (hier Profil 1) hinzu. \\ 

Da wir die Gruppe 4 sind, vergeben wir die IP Adresse 172.16.15.43 und tragen als Vorgaberoute die IP Adresse 172.16.15.249 ein. Der öffentliche DNS server der Uni-Hamburg läuft unter der IP Adresse 134.100.9.61, welche wir ebenfalls eintragen. Die Konfiguration über die GUI sieht dann folgendermaßen aus:

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/sol71.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3 Netzwerkkonfiguration über die GUI]{Netzwerkkonfiguration über die GUI}
\end{figure}

Die Internetverbindung ist nun erfolgreich hergestellt, sodass wir beliebige Webseiten, wie zum Beispiel www.google.de, auf unserer virtuellen Maschine (pnid4-svr-hh -> Server Hamburg) aufrufen können.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/install_nessus/sol72.PNG} 
\end{center}
\caption[Abbildung P4 ex. 3 erfolgreiche Internetverbindung]{erfolgreiche Internetverbindung}
\end{figure}

\section*{Exercise 4: OpenVAS Network device identification}
\addcontentsline{toc}{section}{Exercise 4: OpenVAS Network device identification} 

OpenVAS is a free scanner program. Look at the website
https://www.bsi.bund.de/DE/ Themen/ProdukteTools/OpenVAS/OpenVAS\_node.html\#doc2450430bodyText2 for more information or Google \\

\textbf{OpenVAS includes following features: }\\
a) It is a vulnerability scanner \\
b) It is a port scanner\\
c) It is a host/device detection program\\
d) It can be used to scan Netbios Servers e.g. Windows Servers and Samba Servers e) OpenVAS can be used as a penetrating testing tool\\
f) It is a client-server-system. The server performs the actual scan but it is controlled through the client. Both client and server can be run on the same system\\

\textbf{Do the following steps to install and run OpenVAS:}\\
\textbf{1.} Create a new Nessus virtual machine as shown in figure 1.\\
\textbf{2.} Login with your user name if not existent, please create it.\\
\textbf{3.} \#su- <cr>
\textbf{4.} \# vi /etc/selinux/config Set SELINUX=permissive
\textbf{5.} \# set the ip for this machine to 172.16.15.P, where P stands for the ip address for your reserved ip, see below and change the dns to 134.100.9.61\\

group 1 will be 172.16.15.13 \\
group 2 will be 172.16.15.23\\
group 3 will be 172.16.15.33 \\
group 4 will be 172.16.15.43 \\
group 5 will be 172.16.15.53 \\
group 6 will be 172.16.15.63 \\
group 7 will be 172.16.15.73 \\
group 8 will be 172.16.15.83 \\
group 9 will be 172.16.15.93 \\
group 10 will be 172.16.15.102\\ 
group 11 will be 172.16.15.113 \\
group 12 will be 172.16.15.123\\

\# apt-get update \&\& apt-get install -y openvas \\
\# openvas-setup \\
\# openvasmd --user=admin --new-password=admin \\
\# openvas-start\\

\textbf{6.} Use your webbrowser https:// 10.88.X.P:9392/\\
\textbf{7.} Now you must use openVAS to identify all the devices running on the following network as depicted on figure 1:\\
10.88.X.32/27\\
10.88.X.64/27\\
10.88.X.96/27\\
10.88.X.128/27\\
10.88.X.160/27\\

\textbf{Einleitung OpenVas} \\

OpenVAS (Open Vulnerability Assessment System[1]) ist eine Open Source Software (OSS), die Sicherheitslücken im Netzwerk sammelt und grafisch darstellt. Dabei kann der Benutzer dieses Dienstes die Prüftiefen der Sicherheitsuntersuchungen individuell konfigurieren. Sobald ein Scan durchgeführt ist, stellt OpenVAS eine Vielzahl von informationsreichen Abbildungen dar. Ebenso hat der Benutzer die Möglichkeit in den Prüfberichten zu sehen, um noch genauere und detailliertere Auskünfte einzusehen. Die, durch den Scan, gefundenen Probleme werden in Sicherheitsklassen wie Low und Medium eingestuft, sodass eine Priorität der zu behebenden Schwachstellen sich automatisch erschließen lässt. Es gibt eine Menge Funktionalitäten die ein OpenVAS ermöglicht, einige dieser Funktionalitäten werden in folgedem Absatz stichpunktartig ausgelegt: \\

- Security-Scanning von ganzen Netzwerken \\
- Einbindung verschiedener Sicherheits-Tools dank entsprechender Schnittstellen und Steuerprotokolle \\
- Zentrale Sammlung und Auswertung der Prüfergebnisse \\
- Prüfung von Web Anwendungen möglich\\
- Management von Scan-Aufgaben\\
- Vergleich von Berichten \\
- Benutzeroberfla?che -, GUI- und Web-basiert\\
- Alarmierung bei Richtlinien-Verstoß oder Gefahr \\

\textbf{Installation:} Um OpenVAS zu installieren, sollten wir nach Angaben im Skript folgende Aufgaben lösen: \\
 
1. Create a new Nessus virtual machine as shown in figure 1.  \\
2. Login with your user name if not existent, please create it. \\
3. \# su - <cr>  \\
4. \# vi /etc/selinux/config \\
Set SELINUX=permissive \\

So wie die Anleitung beschreibt haben wir die Schritte durchgeführt und SELINUX = permissive gesetzt. 

\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/1.PNG} 
\end{center}

\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/2.PNG} 
\end{center}

SELinux (Securtiy-Enhanced Linux) ist in allgemeinen eine Erweiterung des Linux Kernels. Es verwaltet die Berechtigungen von unterschiedlichen Unix-Systemen. Die Berechtigung kann von dem Benutzer selbst gesetzt werden. \\

Es ist möglich SELinux im Enforcing oder Permissive Modus zu setzten. Enforcing, wie der name selbst sagt, ist der Modus wo die SELinux Policy erzwungen wird. Im Gegenteil dazu werden im Permissive Modus alle Verletzungen protokolliert, aber nicht verhindert. \\

\textbf{5. \#} set the ip for this machine to 172.16.15.P, where P stands for the ip address for your reserved ip, see below and change the dns to 134.100.9.61, group 4 will be 172.16.15.43  \\

Wie die Aufgabe appelliert, haben wir die IP-Addresse 172.16.15.43 über den DNS 134.100.9.61 für pnid4-klnx1 konfiguriert. 

\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/3.PNG} 
\end{center}

Infolgedessen konnten wir über diese VM eine Verbindung zum Internet aufbauen, als Beispiel hier zu Google.

\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/4.PNG} 
\end{center}

Nachdem wir IPv4 für diese VM eingerichtet haben, lassen wir die Paketlisten (sources.list)  durch den Kommando apt-get update neu einlesen. Es wird auf die Signature dieser Paketlisten gepürft. 

\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/5.PNG} 
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/52.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 apt-get update]{apt-get update}
\end{figure}

Nachdem wir das update durchgeführt haben, installieren wir Pakete wenn es welche gibt auf eine aktuelle Version durch den Kommando apt-get upgrade.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/6.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 apt-get upgrade]{apt-get upgrade}
\end{figure}

Und um openVas vollständig zu installieren, haben wir den Kommendo apt -get install -y openvas genutzt. Das Installieren hat sehr viel Zeit in Anspruch genommen, denn über diesen Kommando werden nicht nur die Pakete installiert, sondern darüber hinaus noch nicht installierte Abhängigkeiten werden ebenfalls installiert. Man sieht dann auch im Terminal welche Packete installisiert wurden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/7.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Installation]{OpenVas Installation}
\end{figure}

Anschließend haben wir OpenVas eingerichtet, indem wir folgenden Kommando in den Terminal eingegeben haben: openvas-setup. Wie der Name bereits verrät ist dieser Kommando für die Einrichtung für OpenVAS da.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/8.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Konfiguration]{OpenVas Konfiguration}
\end{figure}

Im nächsten Schritt haben wir uns einen Benutzer und das dazugehörige Passwort für den Manager daemon über den Kommendaro openvasmd --user=admin --new-password=admin angelegt. Im Anschluss dessen haben wir die Services anhand Eingabe des openvas-start Kommando gestartet.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/10.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas user anlegen]{user anlegen}
\end{figure}

\textbf{6.} Use your webbrowser https:// 127.0.0.1:9392/ \\

Im nächsten Schritt haben wir https://127.0.0.1:9392/ in die Adresszeile unseres Browsers eingegeben und haben unsere Login-Daten eingetippt.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/11.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Login]{Login OpenVas}
\end{figure} 

\textbf{7. }Now you must use openVAS to identify all the devices running on the following network as depicted on figure 1:  \\

Daraufhin haben wir OpenVAS genutzt um alle VM in unserem Netz zu scannen. In Folgenden Bildausschnitten ist zu erkennen, welche VM (mit Angabe der IP-Adresse) gescannt wurde. \\

\textbf{Scan des Subnetzes 10.88.40.32/27:}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.9\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n32.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Scan des Subnetzes 10.88.40.32/27]{Scan des Subnetzes 10.88.40.32/27}
\end{figure} 

\textbf{Scan des Subnetzes 10.88.40.64/27:} 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.9\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n64.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Scan des Subnetzes 10.88.40.64/27]{Scan des Subnetzes 10.88.40.64/27}
\end{figure} 

\textbf{Scan des Subnetzes 10.88.40.96/27:} 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.9\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n96.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Scan des Subnetzes 10.88.40.96/27]{Scan des Subnetzes 10.88.40.96/27}
\end{figure} 

\begin{center}
\includegraphics[width=0.9\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n962.PNG} 
\end{center}

\textbf{Scan des Subnetzes 10.88.40.128/27:} 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n128.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Scan des Subnetzes 10.88.40.128/27]{Scan des Subnetzes 10.88.40.128/27}
\end{figure} 

\begin{center}
\includegraphics[width=0.9\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n1282.PNG} 
\end{center}

\textbf{Scan des Subnetzes 10.88.40.160/27:} 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n160.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Scan des Subnetzes 10.88.40.160/27]{Scan des Subnetzes 10.88.40.160/27}
\end{figure} 

\begin{center}
\includegraphics[width=0.9\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/n1602.PNG} 
\end{center}

Ebenfalls ist hier eine Übersicht aller (10.88.40.32/27 ,10.88.40.64/27 ,10.88.40.96/27 10.88.40.128/27 und 10.88.40.160/27) gescannten Netze. Wir haben 5 Berichte durch den Scan erhalten, welche wir als PDF im Anhang beifügen werden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_4/Exercise_3/openvas/13.PNG} 
\end{center}
\caption[Abbildung P4 ex. 4 OpenVas Scan alle Subnetze]{Scan aller Subnetze}
\end{figure} 


\chapter*{Part 5: Sniffing, Virtual Private Network (VPN)}
\addcontentsline{toc}{chapter}{Part 5: Sniffing, Virtual Private Network (VPN)} 


{\Large \textbf{Theoretische Grundlagen}}\\\\
\textbf{Sniffing}\\\\
Der Begriff Sniffing stammt aus dem englischen und bedeutet übersetzt schnüffeln.
Mit Hilfe eines Tools der Netzwerkanalyse, welches als ein Sniffer bezeichnet wird, ist das Sniffen möglich. Dies bedeutet unter anderem, dass der Datenverkehr eines Netzwerks auf Abnormitäten und potenziellen Gefahren überprüft werden kann. In Detail kann jedes übertragene Paket gelesen werden, Information der Quelle von Paketen und Zielort der Pakete festgestellt werden. Beispielweise kann man mit einem Sniffer Passwörter oder andere Daten auskundschaften.\\\\\\
\textbf{Virtual Private Network}\\\\
Virtual Private Network (kurz: VPN) ist eine Verschlüsselung, die es ermöglicht eine Verbindung über einen VPN-Server zu einem privaten Netzwerk in Echtzeit herzustellen. Dabei ist der Ort von dem man sich Verbinden möchte völlig irrelevant. Demzufolge ist beispielweise die Verbindung vom einem Rechner, welches sich in einem anderen Ort befindet als das Unternehmensnetzwerk, zum Unternehmensnetzwerk realisierbar. Da dies verschlüsselt funktioniert, ist es einem Dritten nicht möglich die übertragenen Informationen abzufangen.

\section*{Exercise 1: Configure and set the networks shown below (figure1 and 2)}
\addcontentsline{toc}{section}{Exercise 1: Configure and set the networks shown below (figure1 and 2)} 

a) Please configure the networks depicted on figure 1 and 2. 
Please scan the Network below( Figure 2) from pnidX-mid-hh to pnidX-cnt-bln and from pnidX-cnt-bln to pnidX-mid-hh.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/1.PNG} 
\end{center}
\caption[ Figur 1]{ Abbildung Figur 1}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/2.PNG} 
\end{center}
\caption[ Figur 2]{ Abbildung Figur 2}
\end{figure}

Wie in der Aufgabe gefordert, haben wir die Netze genauso konfiguriert wie in es im Figur 1 und Figur 2 vorgegeben ist.
Anschließend war es notwendig Zenmap auf beiden virtuellen Maschinen (pnid4-mid-hh und pnid4-cnlt-bln) zu installieren.\\
Zenmap ist ein Nmap Sicherheitsscanner - weitere Infos sind bereits auf S. 19 hinterlegt. Für die Installation von Zenmap haben wir folgendes Kommando genutzt:\\\\
\textbf{yum install nmap-frontend}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/3.PNG} 
\end{center}
\caption[install nmap-frontend] {Abbildung install nmap-frontend}
\end{figure}

Doch wie auf der letzten Abbildung zu sehen ist, konnte ein Paket nicht geladen werden. Dieses Paket haben wir dann auf der nächsten Abbildung explizit installiert, sodass wir Zenmap vollständig installiert haben.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/4.PNG} 
\end{center}
\caption[install nmap-frontend 2] {Abbildung install nmap-frontend 2}
\end{figure}

Folglich haben wir wie in der Aufgabe das Netz von \textbf{pnid4-mid-hh} nach \textbf{pnid4-cnt-bln} gescannt. Somit sah es wie folgt aus:

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/5.PNG} 
\end{center}
\caption[pnid4-mid-hh nach pnid4-cnt-bln] {pnid4-mid-hh nach pnid4-cnt-bln}
\end{figure}

Im folgendem Screenshot ist das Netz \textbf{pnid4-mid-hh} nach \textbf{pnid4-cnt-bln} gescannt:

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/6.PNG} 
\end{center}
\caption[pnid4-mid-hh nach pnid4-cnt-bln 2] {Abbildung pnid4-mid-hh nach pnid4-cnt-bln 2}
\end{figure}

Dasselbe taten wir dann auch für das Netz von \textbf{pnid4-cnt-bln} nach \textbf{pnid4-mid-hh}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/7.PNG} 
\end{center}
\caption[pnid4-cnt-bln nach pnid4-mid-hh] {Abbildung pnid4-cnt-bln nach pnid4-mid-hh}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/8.PNG} 
\end{center}
\caption[pnid4-cnt-bln nach pnid4-mid-hh 2] {Abbildung pnid4-cnt-bln nach pnid4-mid-hh 2}
\end{figure}

\section*{Exercise 2: Getting started with network monitoring tools}
\addcontentsline{toc}{section}{Exercise 2: Getting started with network monitoring tools} 


\textbf{Installation of network monitoring tools }\\\\
Install Wireshark, Wireshark-gnome, vsftpd and telnetd from the Centos6.5 ISO on pnid4-mid-hh and pnid4-cnt-bln. Get familiar (e.g. by using the manuals) with the\\\\
following tools: tcpdump Wireshark \\\\
The tools and manuals are available on the Centos6.5 ISO. Please refer to the internet for more information. You need tcpdump and Wireshark on at least one workstation and on your server.\\\\
For each exercise, analyze the traffic with different tools. \\\\
a) Start the virtual machines as depicted in figure 2 (pnidX-mid-hh server and pnidX- cnt-bln server) connected. Connect from the pnidX-mid-hh to the webserver running on the server pnidX-cnt-bln, if the httpd server on pnidX-cnt-bln is not available, you have to start the httpd server (search google to find out how to do this). \\\\
Follow several links on the server while watching packets flow (with Wireshark and tcpdump). Try other services as well (ftp, ssh, ...). \\\\
Note: Do not forget to install Wireshark and Telnetd Service on server pnidX-mid- hh and pnidX-cnt-bln. \\\\
Connect to the webserver running on 10.88.X.?, (? is an integer >0<254) from a virtual machine. Set filters so you will see only the traffic from your virtual machine to the webserver. Set another filter so you can see only http traffic. Save the TCP-handshake with 10.88.X.? in a file, where X is your group number and ? is your subnet ip address. \\\\\\

In den theoretischen Grundlagen wurde bereits der Ausdruck Sniffing erklärt.Dies wird in diesem Aufgabenteil nochmal aufgegriffen, da wir hier die Sniffing-Tools Wireshark und Tcpdump nutzen.\\\\

Wireshark ist eine freizugängliche Software, welches für die Netzwerküberwachung und grafische Aufbereitung von Sniffern dient. Dabei kann der Anwender sich die Inhalte und die Protokollheader der transportierten Datenpakete anzeigen lassen.\\\\

Auch das Tcpdump ist ein weltweit bekanntes Sniffing-Programm, welches Datenpakete mitschneiden kann. Tcpdump gibt es für die meisten Unix-Betriebssysteme. Doch Tcpdump stellt im Gegensatz zu Wireshark keine grafische Oberfläche für die Analyse bereit. Stattdessen besteht die Möglichkeit, den Netzwerkverkehr über Kommandozeilen mitzuschneiden und diese dann in Wireshark grafisch zu analysieren.\\\\


Um die Analyse der Netzwerkpakete zwischen den Kommunikationsmedien ausarbeiten zu können, haben wir zunächst Wireshark installiert.
Zusätzlich haben wir Libsmi, eine C Biblothek welche den Zugang zu Informationen von MIB Modulen bietet, installiert. 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/9.PNG} 
\end{center}
\caption[installation wireshark] {Abbildung installation wireshark}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/10.PNG} 
\end{center}
\caption[installation libsmi] {Abbildung installation libsmi}
\end{figure}

Anschließend haben wir in exakt dieser Reihenfolge folgendes installiert:\\


\begin{center}
 Httpd - ein freinutzbarer Webserver im Internet von Apache Software Foundation
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/11.PNG} 
\end{center}
\caption[installation httpd] {Abbildung installation httpd}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/12.PNG} 
\end{center}
\caption[installation httpd 2] {Abbildung installation httpd 2}
\end{figure}

\begin{center}
Tcpdump - schneidet transportierte Datenpakete mit
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/13.PNG} 
\end{center}
\caption[installation tcpdump] {Abbildung installation tcpdump}
\end{figure}

\begin{center}
Telnet - ein Netzwerkprotokoll für die Verbindung zu einem anderen Rechner über den Telnet-Server
\end{center}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/14.PNG} 
\end{center}
\caption[installation telnet] {Abbildung installation telnet}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/15.PNG} 
\end{center}
\caption[installation wireshark] {Abbildung installation wireshark}
\end{figure}

Nach den sämtlichen Installationen haben wir für den nächsten Schritt den Kommando \textit{service httpd start} genutzt, somit sind die Dienste von Apache aktiviert worden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/16.PNG} 
\end{center}
\caption[Apache aktivieren] {Abbildung Apache aktivieren}
\end{figure}

Infolgedessen ist uns gelungen eine Verbindung zum Apache http Server herzustellen, wie man auf dem folgenden Screenshot sehen kann. Um dieses aufzurufen, haben wir in der Adresszeile die IP-Adresse unseres lokalen Host eingegeben.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/17.PNG} 
\end{center}
\caption[ Abbildung Verbindung zum http Server] {  Verbindung zum http Server}
\end{figure}

Schließlich haben wir Wireshark gestartet und nach httpd gefiltert, sodass dann die Netzwerkpakete zum Server demonstriert wurden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/18.PNG} 
\end{center}
\caption[ Abbildung Wireshark Analyse] {Wireshark Analyse}
\end{figure}

Wie in der Abbildung 116 zu erkennen, haben wir ebenfalls über Tcpdump den Netzverkehr im Terminal lassen.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/19.PNG} 
\end{center}
\caption[ Abbildung Tcpdump Analyse] {Tcpdump Analyse}
\end{figure}


\section*{Exercise 3: TCPDUMP}
\addcontentsline{toc}{section}{Exercise 3: TCPDUMP} 

In this part of the exercise, you are going to explore tcpdump in more detail. In particular, you will answer more questions involving the use of tcpdump. \\\\
Q1:  Please type and explain the syntax of a tcpdump command that captures packets containing IP datagram with source or destination IP address equal to 10.88.X.$\Delta$ where $\Delta$ is the IP address of pnidX-svr-hh(Centos7). \\
Der Kommando tcpdump -i ens33 gibt an, dass die Netzwerkschnittstelle ens33 analysiert werden soll. Dieses wird solange durchgeführt bis der Service nicht explizit gestoppt wird.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/20.PNG} 
\end{center}
%\caption[Abbildung tcpdump -i ens33] {tcpdump -i ens33}
\end{figure}

Q2:  Please type and explain the syntax of a tcpdump command that captures 12 packets from the eth1 interface of your roudX1-st. \\
Der Kommando tcpdump -c 12 -i ens33 analysiert ebenfalls die Netzwerkschnittstelle ens33,  jedoch nicht wie beim Kommando von Q1 unendlich lang, sondern die Untersuchung wird nach dem 12 Packet automatisch abgebrochen. Dieses ist wegen dem -c praktikabel.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/21.PNG} 
\end{center}
%\caption[Abbildung tcpdump -c 12 -i ens33 ] {tcpdump -c 12 -i ens33}
\end{figure}

Q3:  Please type and explain the syntax of a tcpdump command that captures packets containing ICMP messages with source or destination IP address equal to e.g. 10.88.X.?. 
Durch das eingeben von tcpdump -i ens33 "ip host 10.88.40.130 and icmp" werden die Pakete, die ICMP Nachrichten enthalten, beim Netzwerkverkehr mit IP-Host 10.88.40.130 analysiert.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/22.PNG} 
\end{center}
%\caption[Abbildung tcpdump -c 12 -i ens33 ] {tcpdump -c 12 -i ens33}
\end{figure}

Q4:  Please type and explain the syntax of a tcpdump command that captures packets containing IP datagram between pnidX-mid-hh and pnidX-cnt-bln with IP addresses 10.88.X.? and 10.88.X.P.\\\\
Hier wird die Netzwerkschnittstelle eth4, die Netzwerkpakete zwischen pnid4-mid-hh und pnid4-cnt-bln transportiert analysiert.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/23.PNG} 
\end{center}
%\caption[ ] {}
\end{figure}

Q5: Please type and explain a tcpdump filter expression that captures packets containing TCP segments with source or destination IP address equal to 10.88.X.$\Delta$, where $\Delta$ is the ip address of pnidX-svr-bln. \\\\

Auch bei diesem Kommando ist es notwendig erst tcpdump zu tippen, sodass verstanden wird worum es sich handeln soll. Anschließend muss durch -i Name der Netzwerkschnitte wird verdeutlich um welche Netzwerkschnittstelle es sich handeln soll. Des Weiteren ist leicht zu erkennen, dass zwischen TCP Abschnitte und Ausgangs- bzw. die Zieladresse analysiert werden soll.\\\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/24.PNG} 
\end{center}
%\caption[ ] {}
\end{figure}

Q6:  Please type and explain a tcpdump filter expression that, in addition to the constraints in Q5, only captures packets using port number 23. What is port number 23, which file in Linux/Windows contains port 23 and which path? \\\\
Mit Hilfe des Kommando tcpdump -i ens33 tcp and scr 10.88.50.67 or dst 10.88.40.67 and tcp and port 23 erreichen wir im Grunde dasselbe wie bei Q5, nur mit der Ausnahme das hier nur der Port 23 berücksichtigt wird. Port 23 steht für Telnet und in Linux findet man diesen unter diesem Pfad: /etc/services/telnet 23/tcp

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/25.PNG} 
\end{center}
%\caption[ ] {}
\end{figure}

Q7:  Please type and explain a tcpdump command that collects all ICMP packets with destination IP address 10.88.X.$\Delta$. \\\\

Der Kommando tcpdump -I ens33 -v dst net 10.88.40.67 and icmp fängt alle ICMP-Pakete die als Ziel die IP-Adresse 10.88.40.67 haben.


\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/26.PNG} 
\end{center}
%\caption[ ] {}
\end{figure}

Q8:  Assume we are about to capture all telnet packets destined to IP address 10.88.X.H on port 23 (telnet port). Type and examine the following command and explain if it is correct or not: tcpdump host 10.88.X.$\Delta$ and dst port 23
Accordingly, if not correct, please provide the syntax.\\\\

Dieses Kommando ist richtig, wenn man alle Telnet-Pakete die 10.88.40.35 auf dem Port 23 als Ziel erreichen möchte.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/27.PNG} 
\end{center}
%\caption[ ] {}
\end{figure}


Q9:  Please type and explain the syntax of a tcpdump command that collects all IP packets between host 10.88.X.$\Delta$ and host 10.88.X.P on each interface.\\\\
Tcpdump -i any host 10.88.40.34 and host 10.88.40.38 and icmp bewirkt, dass jedes einzeln übertragenes Netzwerkpaket zwischen 10.88.40.34 und 10.88.40.38 auf beiden Interfaces aufgezeichnet wird.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/28.PNG} 
\end{center}
%\caption[ ] {}
\end{figure}



1.	Start your virtual machine pnidX-mid-hh with IP-address 10.88.X.$\Delta$\\\\

2.	Login as root. \\\\

3.	Create a non-privileged account with the name e.g. "trumpX". \\\\

4.	Create a password for the above user. Make the password "clintonX". \\\\

5.	Try to ping another machine on your network from pnidX-mid-hh to 
pnidX-cnt-bln. \\\\

Um die Frage 10 (Q10) beantworten zu können haben wir zunächst die virtuelle Maschine pnid4-mid-hh gestartet, mit dem Kommando su - und dann das zugehörige Passwort eingegeben. Anschließend haben wir ein Konto mit dem Namen "trump4" und Passwort als "clinton4" eingerichtet. Mit einem ping von pnid4-mid-hh nach pnid4-cnt-bln haben wir bestätigt, dass beide virtuellen Maschinen erreichbar sind und wir mit den folgenden Schritten fortfahren können.\\\\
6.	Try to telnet from pnidX-mid-hh to the virtual machine pnidX-cnt-bln, you 
should be able to login as trumpX. If successful, just log out of pnidX-mid-hh. \\\\


Hier haben wir von der virtuellen Maschine pnid4-mid-hh die virtuelle Maschine pnid4-cnt-cln "getelnet". Dies war durchführbar mit dem Kommando telnet 10.88.40.37.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/29.PNG} 
\end{center}
\caption[Abbildung Telnet mid-hh to cnt-bln ] {Telnet mid-hh to cnt-bln}
\end{figure}

7.	Now, as root on virtual machine pnidX-mid-hh, start tcpdump with the 
command tcpdump -vvv > pnidX-mid-hh-dump.1 \\\\

Dieser Kommando gibt sehr viele Informationen. Je mehr V´s desto mehr Information, wobei das Erste V für very steht, das Zweite V auch für very steht und das Dritte V für verbose.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/30.PNG} 
\end{center}
\caption[Abbildung tcpdump -vvv ] {tcpdump -vvv}
\end{figure}

8. On pnidX-mid-hh, open another shell and telnet from pnidX-mid-hh to pnidX- cnt-bln and login as user "trumpX". Logout of pnidX-cnt-bln. \\\\
Auch in diesem Schritt haben wir uns (pnid4-mid-hh) Mithilfe von telnet unter trump4 angemeldet. Hinterher haben wir uns vom pnid4-cnt-bln abgemeldet.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/31.PNG} 
\end{center}
\caption[Abbildung telnet trump4 ] {telnet trump4 }
\end{figure}

9. 	Stop tcpdump, examine the file pnidX-mid-hh-dump.1 with vi.\\\\
	Durch den Kommand vi pnid4-mid-hh-dump.1 haben wir den folgenden Inhalt anzeigen können:
	
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/32.PNG} 
\end{center}
\caption[Abbildung pnidX-mid-hh-dump.1 ] {pnidX-mid-hh-dump.1}
\end{figure}

10. Now, as root on pnidX-mid-hh, again start tcpdump with the command tcpdump -a -i ethX (X for your interface) > pnidX-mid-hh-dump.2 \\\\
	Hier haben wir den Kommando tcpdump -a -I eth4 > pnid4-cnt-bln-dump.2 ausgeführt.
	
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/33.PNG} 
\end{center}
%\caption[Abbildung  ] {pnidX-mid-hh-dump.1}
\end{figure}

11.	 Again, open another shell on pnidX-mid-hh and ssh from pnidX-mid-hh to pnidX-cnt-bln.
After logging in to pnidX-cnt-bln just logout again.\\\\

Hier haben wir den Kommand ssh an 10.88.40.37 ausgeführt.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/34.PNG} 
\end{center}
%\caption[Abbildung ssh 10.88.40.37 ] {ssh 10.88.40.37}
\end{figure}

12.	Examine the pnidX-mid-hh-dump.2 \\\\
Wie in diesem Schritt gefordert, haben wir die durch vi pnidX-mid-hh-dump.2 den Inhalt angezeigt

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/35.PNG} 
\end{center}
\caption[Abbildung  pnidX-mid-hh-dump.2] {pnidX-mid-hh-dump.2}
\end{figure}


13.	Finally, again as root on pnidX-mid-hh, again start the tcpdump with the command tcpdump -x > pnidX-mid-hh-dump.3 \\\\

Hier haben wir durch den Kommando tcpdump -I eth4 -x > pnid4-cnt-bln-dump.3 die Datenpakete der Netzwerkschnittstelle eth4 mitgeschnitten.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/36.PNG} 
\end{center}
%\caption[Abbildung  pnidX-mid-hh-dump.2] {pnidX-mid-hh-dump.2}
\end{figure}

14.	Again, open another shell on pnidX-mid-hh and from pnidX-mid-hh ftp to pnidX- cnt-bln. When you login to pnidX-cnt-bln, just logout.\\\\
In diesem Fall haben wir ftp 10.88.40.37 ausgeführt.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/37.PNG} 
\end{center}
%\caption[Abbildung  pnidX-mid-hh-dump.2] {pnidX-mid-hh-dump.2}
\end{figure}

15.	Examine the pnidX-mid-hh-dump.3 \\\\


\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/karan/38.PNG} 
\end{center}
\caption[Abbildung  pnidX-mid-hh-dump.3] {pnidX-mid-hh-dump.3}
\end{figure}

Q10: Now answer the following questions: \\\\
1.	What is the difference in the three tcpdump commands? In their outputs?
\\Der Kommand tcpdump -i eth4 -vvv  > pnid4-cnt-bln-dump.1 gibt sehr viele Infromationen aus. Bei je mehr V im Kommando werden desto mehr Details bereitgestellt. \\\\
Für tcpdump -a -i eth4 > pnid4-cnt-bln.dump.2 hier werden alle Pakete von der Netzwerkschnittstelle angesammelt und als ASCII ausgegeben.\\\\
2.	Is it possible to discover "trumplX" password with tcpdump? 
How would you do this? \\
Theoretisch kann man mit tcpdump ein Passwort "sniffen". Mit egrep kann man dies beispielweise durch folgenden Kommando Passwörter aufspüren: \\
\textit{tcpdump port http or port ftp or port smtp or port imap or port pop3\\ -l -A | egrep -i 'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd=|\\password=|pass:|user:|username:|password:|login:|pass |user ' --color=auto --line-buffered -B20}\\\\
3.	How can you tell if a network interface is running in "promiscuous mode"? \\Anhand dem Kommando netstat -i kann man sehen ob ein Interface auf "promiscuous mode" abläuft. Falls ein P unter der Bezeichnung "Flg" bedeutet dies, dass für dieses Interface "promiscuous mode" angeschaltet ist.\\\\
4.	Can a normal, unprivileged user, run tcpdump?\\
	 Nur root kann tcpdump ausführen, da andere User keine Rechte dafür haben.




\section*{Exercise 4: Wireshark}
\addcontentsline{toc}{section}{Exercise 4: Wireshark} 

\textbf{Question 1:} Please type and examine the syntax for a Wireshark command which capture filter so that all IP datagrams with source or destination IP address equal to 10.88.X.? are recorded. \\ 

\textbf{Answer 1:} Mit dem Filter: \textit{ip.addr == 10.88.40.70} können wir alle Netzwerkpakete, welche über die Schnittstelle 10.88.40.70 gesendet oer empfangen werden, abfangen und anzeigen lassen.\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.6\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q1.PNG} 
\end{center}
\caption[Abbildung P5 ex. 4 Wireshark Filter 1]{Wireshark Filter ip.addr == 10.88.40.70}
\end{figure}

\textbf{Question 2:} Please type and examine the syntax for a Wireshark display filter that shows IP datagrams with destination IP address equal to 10.88.X.? and frame size greater than 400 bytes. \\

\textbf{Answer 2:} Um alle Datenpakete abzufangen, die mindestens 400 Byte groß sind, bedarf eine kleine Erweiterung des vorherigen Befehls. Der Filter lautet nun: \textit{ip.addr == 10.88.40.70 \&\& frame.len > 400}. Mit dem Teil \textit{frame.len > X} können wir die Datenpakete nach Bytegröße X Filtern. Für X gilt, X $< 2^{32}$ $\wedge$ X $\in \mathbb{N}$. 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.55\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q2.PNG} 
\end{center}
\caption[Abbildung P5 ex. 4 Wireshark Filter 2]{Wireshark Filter ip.addr == 10.88.40.70 \&\& frame.len > 400}
\end{figure}

\textbf{Question 3:} Please type and examine the syntax for a Wireshark display filter that shows packets containing ICMP messages with source or destination IP address equal to 10.88.X.? and frame numbers between 15 and 30 \\

\textbf{Answer 3:} Der Filter lautet: \textit{ip.addr == 10.88.40.70 \&\& (frame.number > 15 \&\& frame.number < 30)}. ICMP steht für Internet Control Message Protocol und übermittelt hauptsächlich Diagnose-informationen zwischen dem Router und dem Host. \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.7\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q3.PNG} 
\end{center}
\caption[Abbildung P5 ex. 4 Wireshark Filter 3]{Wireshark Filter ip.addr == 10.88.40.70 \&\& (frame.number > 15 \&\& frame.number < 30)}
\end{figure}

\textbf{Question 4:} Please type and examine the syntax for a Wireshark display filter that shows packets containing TCP segments with source or destination IP address equal to 10.88.X.? and using port number 23. \\

\textbf{Answer 4:} Damit wir alle TCP Pakete eines Hosts über die Port 23 abfangen können wird der folgende Filter eingesetzt: \textit{ip.dst == 10.88.40.70 and tcp.port == 23}. Bei TCP handelt es sich um ein Übertragungsprotokoll (Transmission Control Protocol) aus der Familie der Internetprotokolle. Port 23 ist standardisiert für den Service Telnet. 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q4.PNG} 
\end{center}
\caption[Abbildung P5 ex. 4 Wireshark Filter 4]{Wireshark Filter ip.dst == 10.88.40.70 and tcp.port == 23}
\end{figure}


\textbf{Question 5:} Please type and examine a Wireshark capture filter expression for Q4. \\  

\textbf{Answer 5:} Der Filter ist ähnlich wie in Q4, lediglich die Konfiguration findet an einer anderen Stelle statt. \\ 

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q5.PNG} 
\end{center}
\caption[Abbildung P5 ex. 4 Wireshark Filter 5]{Wireshark Filter host 10.88.40.70 \&\& tcp port 23}
\end{figure}

\textbf{Question 6:} Please type and examine the syntax for a Wireshark command which, by default, collects packets with source or destination IP address 10.88.X.? on interface eth4. \\

\textbf{Answer 6:} Innerhalb des Terminals lässt sich der Filter: \textit{wireshark -i eth4 -k -f "host 10.88.40.70"}, anwenden. Die Argumente bedeuten dabei folgendes: -i eth4 steht für Interface, -k startet das Abfangen von Paketen und -f "host 10.88.40.70", ist der Paketfilter.\\

\textbf{Question 7:} : Please type and examine the syntax of a display filter which selects the TCP packets with destination IP address 10.88.X.?, and TCP port number 23.\\

\textbf{Answer 7:} Der Filter lautet: \textit{ip.addr == 10.88.40.70 \&\& tcp.port == 23} und fängt alle ein-/ausgehenden Pakete der Ip Adresse 10.88.40.70 über den Port 23 (Telnet) ab.\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q7.PNG} 
\end{center}
\caption[Abbildung P5 ex. 4 Wireshark Filter 7]{Wireshark Filter ip.addr == 10.88.40.70 \&\& tcp.port == 23}
\end{figure}

\textbf{Question 8:} Please login to the server pnidX-mid-hh and start an ftp client to the server pnidXcnt-bln(vsftpd
daemon should be running on pnidX-cnt-bln). Please use
wireshark on pnidX-mid-bln to sniff or capture the username and password of the ftp service between pnidX-mid-hh and pnidX-cnt-bln. Is this possible, show your result of the capture\\

\textbf{Answer 8:} Mithilfe von Wireshark können wir leicht das ftp login Passwort herausfinden, da bei der Übertragung via ftp die Pakete unverschlüsselt übertragen werden. Dazu starten wir zunächst Wirehsark auf dem Host pnid4-mid-hh und führen ein ftp login, von cnt-bln nach mid-hh, durch. Zuerst muss der Service ftp auf beiden Host aktiv sein, deshalb überprüfen wir den Status. \\

\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q81.PNG} 
\end{center}

Danach starten wir wireshark auf dem Host mid-hh und melden uns über den Host cnt-bln bei dem Host mid-hh über den ftp servie an.  \\

\begin{center}
\includegraphics[width=0.3\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q83.PNG} 
\end{center} 

Über die Ausgabe Login successfull sehen wir, dass das anmelden erfolgreich war. Wir öffnen nun Wireshark auf dem Host mid-hh und filtern nach ftp Paketen. Dazu reicht es aus ftp in die Filtermaske einzugeben.\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q82.PNG} 
\end{center} 
\caption[Abbildung P5 ex. 4 Wireshark Filter 8]{Wireshark Filter ftp}
\end{figure}

Wir schauen uns nun die Pakete genauer an und können die Logininformationen in einem der Pakete anzeigen lassen. \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.4\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q84.PNG} 
\caption[Abbildung P5 ex. 4 Wireshark ftp Login Passwort]{Wireshark ftp Login Passwort}
\end{center} 
\end{figure}

Sofort sehen wir den Benutzernamen trump4 und das Passwort clinton4. Dieses Szenario zeigt wie einfach es ist die Logininformationen herauszulesen, wenn die Datenpakete unverschlüsselt übertragen werden. 

\textbf{Question 9:} Please login to the server pnidX-mid-hh and start an ssh client to the server
pnidX-cnt-bln(sshd daemon should be running on pnidX-cnt-bln). Please use wireshark on pnidX-mid-bln to sniff or capture the username and password of the ssh service between pnidX-mid-hh and pnidX-cnt-bln. Is this possible, show the result of the capture. \\

\textbf{Answer 9:} Anders als ftp werden bei shh (Secure Shell) die Pakete verschlüsselt übertragen, sodass es nicht möglich ist das Passwort mitzulesen. Zuerst prüfen wir, ob der der ssh service auf beiden Hosts aktiv ist. \\

\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q91.PNG} 
\end{center}

Danach starten wir wireshark auf dem Host mid-hh und melden uns über den Host cnt-bln bei dem Host mid-hh über den ssh servie an.  \\

\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q92.PNG} 
\end{center}

Über die Ausgabe Last login..., sehen wir, dass das anmelden erfolgreich war. Wir öffnen nun Wireshark auf dem Host mid-hh und filtern nach ssh Paketen. Dazu reicht es aus ssh in die Filtermaske einzugeben.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q93.PNG} 
\end{center} 
\caption[Abbildung P5 ex. 4 Wireshark Filter 9]{Wireshark Filter ssh}
\end{figure}

Wir schauen uns nun die Pakete genauer an und können keine Informationen über das Login erhalten, da alle Datenfragmente verschlüsselt wurden. \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_4/Q94.PNG} 
\end{center} 
\caption[Abbildung P5 ex. 4 Wireshark ssh Datenpaket]{Wireshark verschlüsselte Datenfragmente}
\end{figure}

\section*{Exercise 5: Experimenting with network monitoring tools}
\addcontentsline{toc}{section}{Exercise 5: Experimenting with network monitoring tools} 

\textbf{Exercise:} In this exercise you will connect to the webserver pnidX-cnt-bln from pnidX-mid-hh. Let pnidX-cnt-bln determine your IP-address and the OS you are running. Then, connect to
a service of your choice (e.g. ftp, http, ssh etc.) on pnidX cnt-bln. Let pnidX-mid-hh determine which services are running on pnidX-cnt-bln. \\

\textbf{Solution:} Wir führen zunächst nmap auf dem Host pnid4-cnt-bln aus und übergeben dabei die Zieladresse des Hosts pnid4-mid-hh, damit wir sehen können welche Ports geöffnet sind bzw. welcher Service auf dem Zielhost gerade aktiv ist.

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.45\textwidth]{bilder/screens/Part_5/Aufgabe_5/s1.PNG} 
\end{center} 
\caption[Abbildung P5 ex. 5 nmap offene Ports anzeigen]{Zeigt uns die offenen Ports an}
\end{figure}

Wir sehen nun, dass die Ports 21 ftp, 22 ssh, 23 telnet, 80 http und 111 rpcbind offen sind und entscheiden uns via Telnet vom Quellhost pnid4-cnt-bln bei dem Zielhost pnid-mid-hh anzumelden. \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.45\textwidth]{bilder/screens/Part_5/Aufgabe_5/s2.PNG} 
\end{center} 
\caption[Abbildung P5 ex. 5 Telnet login]{Anmeldung via Telnet}
\end{figure}

Die Ausgabe des letzten Logins zeigt uns, dass die Anmeldung erfolgreich war.  


\section*{Exercise 6: Set up a host-to-host VPN using preshared key}
\addcontentsline{toc}{section}{Exercise 6: Set up a host-to-host VPN using preshared key} 
\textbf{VPN: Host-to-host} \\
Bei einem Host-to-Host-VPN greift ein Client auf einen anderen Clienten in einem entfernten Netzwerk zu. Dabei wird ein VPN-Tunnel aufgebaut, der die zwei Hosts miteinander verbindet. Auf beiden Seiten muss eine entsprechende VPN-Software installiert und konfiguriert sein. Der Verbindungsaufbau geschieht im Allgemeinen nur durch die Unterstützung einer zwischengeschalteten Station. Das bedeutet, eine direkter Verbindungsaufbau von Host zu Host ist nicht möglich. Daher bauen beide Seiten eine Verbindung zu einem Router auf, dass die beiden Verbindungen dann zusammenbringt.\\
Da man die Daten sicher über das Internet übertragen möchte, versucht man mittels eines Tunneling-Protokolls eine verschlüsselte Verbindung, den VPN-Tunnel aufzubauen. Wenn der Tunnel aufgebaut ist, ist der Inhalt der Daten für andere nicht sichtbar. Einzelne Clients bindet man in der Regel per Tunnelmodus an. \\\\
\textbf{Preshared-Key:}\\
Ein \textbf{symmetrisches }Verschlüsselungsverfahren, bei dem die Schlüssel schon zu Beginn der Kommunikation beiden Partnern bekannt ist. Vorher müssen diese Schlüssel jedoch im Geheimen ausgetauscht werden. Für viele Anwendungen im Internet ist dieses Verfahren ungeeignet, da hierfür ein großer Aufwand notwendig wäre.\\

To create a host-to-host VPN as shown in Figure 1 using preshared keys both systems must have OPENS/WAN properly installed and tested. Next, you must ensure that IP networking is functioning. For this exercise you will capture http packets between the hosts. This capture will allow you to compare and prove that IPSec is functioning after the tunnel is created between the hosts. Make sure Apache and Wireshark are installed. See Figure 1. \\
Hints: CREATING PRESHARED KEY use ipsec ranbits 256 > filename \\ \\ \\\\
{\large \textbf{Installation von Openswan auf beiden Rechnern Hamburg (pnid4-mid-hh) und Berlin (pnid4-cnt-bln)}}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_5/Aufgabe_6/b1.PNG} 
\end{center} 
\caption[Abbildung P5 Installation Openswan]{Installation Openswan}
\end{figure} 

\newpage {\large \textbf{Netzwerk für die Konfiguration der VPN-Verbindung}}
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_5/Aufgabe_6/b2.PNG} 
\end{center} 
\caption[Abbildung P5 Figure 1: HOST-TO-HOST-VPN]{Figure 1: HOST-TO-HOST-VPN}
\end{figure}

i) Capture http packets between pnidX-mid-hh and pnidX-cnt-bln using 
Wireshark before establishing a tunnel and save the packet captured. Please include this with your lab report. \\
Vor der Einrichtung von Openswan können HTTP-Pakete von beliebigen Angreifern ohne Probleme abgehört werden. VPN soll dafür sorgen, dass dies verhindert wird. Zunächst starten wir auf pnid4-cnt-bln Wireshark, um HTTP-Pakete abzufangen. Um HTTP-Pakete von pnid4-mid-hh abzufangen, geben wir den Filter \dq dst 10.88.40.130 \&\& tcp \&\& port 80\dq ein (siehe Abbildung ..).
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_5/Aufgabe_6/b3.PNG} 
\end{center} 
\caption[Abbildung P5 dst 10.88.40.130 \&\& tcp \&\& port 80]{dst 10.88.40.130 \&\& tcp \&\& port 80}
\end{figure}

Auf dem Rechner pnid4-cnt-bln wird im Browser die IP-Adresse von pnid4-mid-hh eingeben, um HTTP-Pakete abzufangen (siehe Abbildung 139)

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{bilder/screens/Part_5/Aufgabe_6/b4.PNG} 
\end{center} 
\caption[Abbildung P5 http://10.88.40.130]{http://10.88.40.130}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_5/Aufgabe_6/b5.PNG} 
\end{center} 
\caption[Abbildung P5 Filter: dst 10.88.40.130 \&\& tcp \&\& port 80]{Filter: dst 10.88.40.130 \&\& tcp \&\& port 80}
\end{figure}

ii) Establish a tunnelled IPSec connection, using a 256 preshared secret. 
Confirm that the connection is established. \\
Capture again http packets between pnidX-mid-hh and pnidX-cnt-bln 
using Wireshark after establishing a tunnel and save the packet captured. Please include this with your lab report. \\ \\
Mit Hilfe des Befehls \# ipsec ranbits 256 > psk.secrets wird ein zufällig erzeugter Key generiert, der in der Datei psk.secrets gespeichert wird.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/2.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec ranbits 256 >]{ipsec ranbits 256 >}
\end{figure}

Die Datei wird so angepasst, dass Sie folgende Struktur bekommt:\\
\% IP-Adresse-mid-hh \% IP-Adresse-cnt-bln : PSK \dq der\_Key\_welches\_über\_ipsec\_ranbits\_generiert wurde \dq (siehe Abb. ..)

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/2a.PNG} 
\end{center} 
\caption[Abbildung P5 psk.secrets]{psk.secrets}
\end{figure}

\newpage Als nächstes wird die psk.conf Datei erstellt, welches sich ebenfalls im Verzeichnis ipsec.d befindet. Hier erfolgt die Konfiguration des Tunnels. Dabei wird die Authentifizierung über authby angegeben. Mit type wird der Typ der Verbindung (tunnel, transport) bezeichnet. Die betroffenen Kommunikationspartner werden mit left und right dargestellt. Left bezeichnet dabei den Host, auf den wir uns befinden. Right hingegen bezeichnet den dazugehörigen Kommunikationspartner. Left und right entsprechen dabei die IP-Adressen der jeweiligen Kommunikationspartner. Auto bezeichnet die Operation, welche beim starten von IPsec ausgeführt werden soll. \\ \\

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/2b.PNG} 
\end{center} 
\caption[Abbildung P5: psk.conf]{psk.conf}
\end{figure}

\newpage Damit alle Dateien innerhalb des Verzeichnisses /etc/ipsec.d mit der Endung .conf eingebunden werden können, muss die letzte Zeile (siehe Abb. ) auskommentiert werden.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/3.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

Damit beide Kommunikationspartner dieselben Dateien haben, wird die Datei psk.secrets und die Datei psk.conf mit dem Befehl scp zum jeweils anderen Kommunikationspartner geschickt. Scp(Secure Copy) ist ein Protokoll und sorgt für eine verschlüsselte Übertragung von Daten zwischen zwei Computern.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/3a.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

\newpage \textbf{Auf beiden Rechnern wird ipsec gestartet:}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/4.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec setup reload]{ipsec setup reload}
\end{figure}

Mit dem Befehl \verb|ipsec auto --add| wird eine neue Verbindung aus der Konfigurationsdatei in die Pluto-Datenbank eingelesen.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/5.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec auto --add]{ipsec auto --add}
\end{figure}

Mit dem Befehl \verb|ipsec auto --up psk| wird die Verbindung gestartet. Dabei versucht Pluto in der internen Datenbank der geladenen Konfiguration die benötigte Verbindung aufzubauen.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/6.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec auto --up]{ipsec auto --up}
\end{figure}

\newpage Pluto ist der IKE-Daemon, der das IKE-Protokoll implementiert. Pluto erstellt automatische Sicherheitsbeziehungen, die untereinander geteilt werden. Für die Authentifikation verwendet Pluto Shared Secrets oder RSA Signaturen.
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/ii/7.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

iii) Secure the computer traffic by creating iptables rules to permit only IPSec traffic between the two computers. All other, non-IPSec packets must be denied.\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iii/1.PNG} 
\end{center} 
\caption[Abbildung P5 iptables rules]{iptables rules}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iii/2.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iii/4.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.85\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iii/5.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

\newpage iv) After a successful IPSec connection has been established, create the following files using the given commands: \\
File ipsec\_ifconfig.dump \\
ifconfig > ipsec\_fconfig.dump \\
File ipsec\_look.dump \\
ipsec look > ipsec\_look.dump \\
File ipsec\_route.dump \\
Route -n > ipsec\_route.dump \\
The following files must be included with the lab report: \\
1) /etc/ipsec.secrets \\
2) /etc/ipsec.conf \\
3) /etc/ipsec\_iptables - a file which contains your iptables rules \\
4) ipsec\_ifconfig.dump \\
5) ipsec\_look.dump \\
6) ipsec\_route.dump\\

\textbf{Files from Berlin:}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/bln/1.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

\textbf{1) /etc/ipsec.secrets }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/bln/2.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\newpage \textbf{2) /etc/ipsec.conf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/bln/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/bln/4.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables ]{/etc/ipsec\_iptables }
\end{figure}

\newpage \textbf{4) ipsec\_ifconfig.dump }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/bln/5.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_ifconfig.dump]{ ipsec\_ifconfig.dump}
\end{figure}

\textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/bln/6.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_look.dump]{ ipsec\_look.dump}
\end{figure}

\textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/bln/7.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Files from Hamburg:}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/mid/1.PNG} 
\end{center} 
%\caption[Abbildung P5]{}
\end{figure}

\textbf{1) /etc/ipsec.secrets }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/mid/2.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{2) /etc/ipsec.conf}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/mid/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\newpage \textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/mid/4.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables]{/etc/ipsec\_iptables}
\end{figure}

\textbf{4) ipsec\_ifconfig.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/mid/5.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_ifconfig.dump]{ipsec\_ifconfig.dump}
\end{figure}

\newpage \textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/mid/6.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_look.dump]{ipsec\_look.dump}
\end{figure}

\textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/Aufgabe_6/A6/iv/mid/7.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\section*{Exercise 7: Set up a host-to-host VPN using RSA keys}
\addcontentsline{toc}{section}{Exercise 7: Set up a host-to-host VPN using RSA keys}

\textbf{RSA ist ein asymmetrisches Verschlüsselungsverfahren.} Diese verwendet man zum Verschlüsseln und Signieren. Es besteht aus einem Schlüsselpaar, weclhes sich zusammensetzt aus einem öffentlichen und privaten Schlüssel. Mit dem \textbf{öffentlichen Schlüssel verschlüsselt} man die Nachricht oder prüft Signaturen. Mit dem \textbf{privaten Schlüssel} hingegen \textbf{entschlüsselt} man die Nachricht.\\

Hints: CREATING RSA PRIVATE KEYS SECRETS do the following:\\
a) certutil -N -d /etc/ipsec.d\\
b) \verb|ipsec newhostkey --configdir /etc/ipsec.d/ --output /etc/ipsec.d/keys.secrets|\\
To create a host-to-host VPN as shown in figure 1, using RSA keys both systems must have OPENS/WAN properly installed and tested. Next, you must ensure that IP networking is functioning. For this exercise you will capture http packets between the hosts. This capture will allow you to compare and prove that IPSec is functioning after the tunnel is created between the hosts. Make sure Apache and Wireshark are installed.\\
i) Capture http packets between pnidX-mid-hh and pnidX-cnt-bln using
Wireshark before establishing a tunnel and save the packet captured. Please include this with your lab report\\
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/i/1.PNG} 
\end{center} 
\caption[Abbildung P5 dst 10.88.40.130 \&\& tcp port 80]{dst 10.88.40.130 \&\& tcp port 80}
\end{figure}
ii) Establish a tunnelled IPSec connection, using RSA Method between the two computers.\\
Confirm that the connection is established.\\
Capture again http packets between pnidX-mid-hh and pnidX-cnt-bln
using Wireshark after establishing a tunnel and save the packet captured. Please include this with your lab report\\

\newpage \textbf{Privaten RSA-Schlüssel generieren} \\
a) certutil -N -d /etc/ipsec.d
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/bln/1.PNG} 
\end{center} 
\caption[Abbildung P5 Berlin: certutil -N -d /etc/ipsec.d]{certutil -N -d /etc/ipsec.d}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/mid/1.PNG} 
\end{center} 
\caption[Abbildung P5 Hamburg: certutil -N -d /etc/ipsec.d]{certutil -N -d /etc/ipsec.d}
\end{figure}

\newpage b) \verb|ipsec newhostkey --configdir /etc/ipsec.d/ --output /etc/ipsec.d/keys.secrets|\\ 
\textbf{Der Befehl generiert 2 RSA Authentifikationsschlüssel für Hamburg und Berlin.}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/bln/2.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec newhostkey - - configdir /etc/ipsec.d/ - - output /etc/ipsec.d/keys.secrets]{ipsec newhostkey - - configdir /etc/ipsec.d/ - -output /etc/ipsec.d/keys.secrets}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/mid/2.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec newhostkey - - configdir /etc/ipsec.d/ - - output /etc/ipsec.d/keys.secrets]{ipsec newhostkey - - configdir /etc/ipsec.d/ - - output /etc/ipsec.d/keys.secrets}
\end{figure}

Die \textbf{rsa.conf} -Datei wird auf beiden Rechnern wie folgt angepasst.
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/bln/3.PNG} 
\end{center} 
\caption[Abbildung P5 rsa.conf]{rsa.conf}
\end{figure}

\newpage \textbf{Auf beiden Rechnern wird ipsec gestartet:}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/bln/4.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec setup reload]{ipsec setup reload}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/mid/4.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec setup reload]{ipsec setup reload}
\end{figure}

\textbf{Die Verbindung wird in die Datenbank eingelesen:}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/mid/5.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec auto - - add rsa]{ipsec auto - - add rsa}
\end{figure}

\textbf{Verbindung wird hergestellt und ein Tunnel aufgebaut.}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/mid/6.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec auto - - up rsa]{ipsec auto - - up rsa}
\end{figure}

\newpage iii) Secure the computer traffic by creating iptables rules to permit only IPSec traffic between the two computers. All other, non-IPSec packets must be denied. \\

\textbf{iptables Rules für Hamburg:}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iii/mid/1.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec auto - - up rsa]{ipsec auto - - up rsa}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iii/mid/2.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec auto - - up rsa]{ipsec auto - - up rsa}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iii/mid/3.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec auto - - up rsa]{ipsec auto - - up rsa}
\end{figure}

\textbf{iptables Rules für Berlin:}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iii/bln/1.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec auto - - up rsa]{ipsec auto - - up rsa}
\end{figure}

iv) After a successful IPSec connection has been established, create the following files using the given commands: \\
File ipsec\_ifconfig.dump \\
ifconfig > ipsec\_fconfig.dump \\
File ipsec\_look.dump \\
ipsec look > ipsec\_look.dump\\
File ipsec\_route.dump\\
\verb|Route -n > ipsec\_route.dump|\\
The following files must be included with the lab report:\\
1) /etc/ipsec.secrets\\
2) /etc/ipsec.conf\\
4) ipsec\_ifconfig.dump\\
4) ipsec\_look.dump\\
5) ipsec\_route.dump \\

\textbf{Files from Berlin:}

\textbf{1) /etc/ipsec.secrets }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/bln/4.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\newpage \textbf{2) /etc/ipsec.conf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/bln/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iii/bln/1.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables ]{/etc/ipsec\_iptables }
\end{figure}

\newpage \textbf{4) ipsec\_ifconfig.dump }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/bln/1.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_ifconfig.dump]{ ipsec\_ifconfig.dump}
\end{figure}

\textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/bln/2.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_look.dump]{ ipsec\_look.dump}
\end{figure}

\newpage \textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/bln/3.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Files from Hamburg:}\\
\textbf{1) /etc/ipsec.secrets }\\
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/mid/4.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{2) /etc/ipsec.conf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/ii/mid/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iii/mid/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables ]{/etc/ipsec\_iptables }
\end{figure}

\textbf{4) ipsec\_ifconfig.dump }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/mid/1.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_ifconfig.dump]{ ipsec\_ifconfig.dump}
\end{figure}

\newpage \textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/mid/2.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_look.dump]{ ipsec\_look.dump}
\end{figure}

\textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_7/iv/mid/3.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\section*{Exercise 8: Set up a network-to-network VPN using preshared key}
\addcontentsline{toc}{section}{Exercise 8: Set up a network-to-network VPN using preshared key}
To create a network-to-network VPN as shown in Figure 3 using preshared key both systems must have OPENS/WAN properly installed and tested. Next, you must ensure that IP networking is functioning. For this exercise you will capture http packets between the hosts. This capture will allow you to compare and prove that IPSec is functioning after the tunnel is created between the hosts. Make sure Apache and Wireshark are installed.\\\\

Network-to-network ist eine VPN-Situation, indem eine Vielzahl lokaler Netzwerke zu einem virtuellen Netzwerk zusammengeschaltet werden. Ebenfalls besteht die Möglichkeit eine Festverbindung zwischen den verschiedenen Netzwerken, die an unterschiedlichen Orten sind, herzustellen. Jedoch ist der Kostenaufwand hierfür deutlich höher als wenn man die Netzwerke mit einer VPN-Verbindung über das Internet aufbaut. 

i) Test connectivity between pnidX-mid-hh and pnidX-cnt-bln using ping,
see figure 3 and save the result.\\
\textbf{Ping between pnid4-mid-hh and pnid4-cnt-bln}
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_5/aufgabe_8/1.PNG} 
\end{center} 
\caption[Abbildung P5 ping-Ergebnis]{ping-Ergebnis}
\end{figure}

\textbf{Zenmap between pnid4-mid-hh and pnid4-cnt-bln}
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_5/aufgabe_8/2.PNG} 
\end{center} 
\caption[Abbildung P5 zenmap for testing the connectivity]{zenmap for testing the connectivity}
\end{figure}

\newpage ii) Capture http packets from pnidX-mid-hh to pnidX-cnt-bln
see figure 3, by using Wireshark on pnidX-kln-st before establishing a tunnel and save the packet captured.\\Please include this with your lab report\\

\textbf{HTTP-Pakete mit Wireshark filtern} \\
dst 10.88.40.130 \&\& tcp \&\& port 80
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/3.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/4.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\newpage iii) Establish a tunnelled IPSec connection, using the preshared key Method between the two gateways. Confirm that the connection is established.
Capture again http packets from pnidX-mid-hh to pnidX-cnt-bln
see figure 3, by using Wireshark on pnidX-kln-st after establishing a tunnel and save the packet captured. Please include this with your lab report\\

Mit Hilfe des Befehls \# ipsec ranbits 256 > net-to-net-psk.secrets wird ein zufällig erzeugter Key generiert, der in der Datei net-to-net-psk.secrets gespeichert wird.

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/01.PNG} 
\end{center} 
\caption[Abbildung P5 net-to-net-psk.secrets]{net-to-net-psk.secrets}
\end{figure}

\textbf{Konfiguration der net-to-net-psk.conf Datei}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/02.PNG} 
\end{center} 
\caption[Abbildung P5 net-to-net-psk.conf]{net-to-net-psk.conf}
\end{figure}

Da auf beiden Rechnern, dieselbe secrets und conf Datei ist, senden wir diese mit dem scp Protokoll rüber.
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/03.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Auf beiden Rechnern wird ipsec gestartet}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/04.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Der Status wird geprüft}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/05.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Verbindung wird hergestellt und Tunnel aufgebaut}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/06.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Status wird erneut geprüft}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/07.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{2 Tunnels up}
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.75\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/08.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{HTTP-Pakete mittels Wireshark filtern}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iii/09.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

iv) Secure the computer traffic by creating iptables rules to permit only IPSec traffic between the two gateways. All other, non-IPSec packets must be denied.\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iv/01.PNG} 
\end{center} 
\caption[Abbildung P5 creating iptables rules]{creating iptables rules}
\end{figure}

\textbf{iptable rules mid-hh}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iv/02.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{iptable rules cnt-bln}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iv/03.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

v) After a successful IPSec connection has been established, create the following files using the given commands:\\
File ipsec\_ifconfig\_shared.dump \\
ifconfig > ipsec\_ifconfig\_Shared.dump\\
File ipsec\_look\_shared.dump\\
ipsec look > ipsec\_look\_shared.dump\\
File ipsec\_route\_shared.dump\\
route - n > ipsec\_route\_shared.dump\\
The following files must be included with the lab report:\\
1) /etc/ipsec.secrets (shared key)\\
2) /etc/ipsec.conf (shared key)\\
3) ipsec\_ifconfig\_shared.dump\\
4) ipsec\_look\_shared.dump\\
5) ipsec\_route\_shared.dump\\

\textbf{Files from Berlin:}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/bln/1.PNG} 
\end{center} 
%\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{1) /etc/ipsec.secrets }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/bln/2.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{2) /etc/ipsec.conf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/bln/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iv/03.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables ]{/etc/ipsec\_iptables }
\end{figure}

\textbf{4) ipsec\_ifconfig.dump }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/bln/4.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_ifconfig.dump]{ ipsec\_ifconfig.dump}
\end{figure}

\textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/bln/5.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_look.dump]{ ipsec\_look.dump}
\end{figure}

\textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/bln/6.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Files from Hamburg:}\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/hh/1.PNG} 
\end{center} 
%\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{1) /etc/ipsec.secrets }\\
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/hh/2.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{2) /etc/ipsec.conf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/hh/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/iv/02.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables ]{/etc/ipsec\_iptables }
\end{figure}

\textbf{4) ipsec\_ifconfig.dump }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/hh/4.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_ifconfig.dump]{ ipsec\_ifconfig.dump}
\end{figure}

\textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/hh/5.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_look.dump]{ ipsec\_look.dump}
\end{figure}

\textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_8/v/hh/6.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\section*{Exercise 9: Set up a network-to-network VPN using RSA secrets keys}
\addcontentsline{toc}{section}{Exercise 9: Set up a network-to-network VPN using RSA secrets keys}
To create a network-to-network VPN as shown in Figure 2 using RSA keys both systems must have OPENS/WAN properly installed and tested. Next, you must ensure that IP networking is functioning. For this exercise you will capture http packets between the hosts. This capture will allow you to compare and prove that IPSec is functioning after the tunnel is created between the hosts. Make sure Apache and Wireshark are installed. \\\\
i) Test connectivity between pnidX-mid-hh and pnidX-cnt-bln using ping,
see figure 2 and save the result.\\

\textbf{Ping between pnid4-mid-hh and pnid4-cnt-bln}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/1.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Zenmap between pnid4-mid-hh and pnid4-cnt-bln}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/2.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

ii) Capture http packets from pnidX-mid-hh to pnidX-cnt-bln
see figure 2, by using Wireshark on pnidX-kln-st before establishing a tunnel and save the packet captured. Please include this with your lab report\\

\textbf{HTTP-Pakete mit Wireshark filtern} \\
\textbf{dst 10.88.40.130 \&\& tcp \&\& port 80}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/3.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/4.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

iii) Establish a tunnelled IPSec connection, using the RSA Method between the
two gateways pnidX-gw-hh and pnidX-gw-bln \\
Confirm that the connection is established. \\
Capture again http packets from pnidX-mid-hh to pnidX-cnt-bln
see figure 2, by using Wireshark on pnidX-kln-st after establishing a tunnel and save the packet captured. Please include this with your lab report.\\\\

 \textbf{Privaten RSA-Schlüssel generieren auf beiden Gateways} \\
 \textbf{a) certutil -N -d /etc/ipsec.d}\\

 \textbf{privater Schlüssel von Gateway-Berlin}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/bln/1.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{privater Schlüssel von Gateway-Hamburg}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/hh/1.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{b)} \verb|ipsec newhostkey --configdir /etc/ipsec.d/ --output /etc/ipsec.d/keys.secrets|\\
\textbf{Der Befehl generiert 2 RSA Authentifikationsschlüssel für die beiden Gateways.}

\textbf{net-to-net-rsa.secrets}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/bln/2.PNG} 
\end{center} 
\caption[Abbildung P5 Berlin: net-to-net-rsa.secrets]{ net-to-net-rsa.secrets}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/hh/2.PNG} 
\end{center} 
\caption[Abbildung P5 Hamburg: net-to-net-rsa.secrets]{net-to-net-rsa.secrets}
\end{figure}

\textbf{net-to-net-rsa.conf}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/bln/3.PNG} 
\end{center} 
\caption[Abbildung P5 net-to-net-rsa.conf]{net-to-net-rsa.conf}
\end{figure}


\textbf{ipsec wird gestartet auf beiden Gateways}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/bln/4.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/hh/4.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Verbindung wird in Datenbank eingelesen}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/hh/5.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Verbindung wird hergestellt und ein Tunnel baut sich auf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/hh/6.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{2 Tunnels up}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iii/bln/5.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

iv) Secure the computer traffic by creating iptables rules to permit only IPSec traffic between the two gateways. All other, non-IPSec packets must be denied.\\

\textbf{iptable rules für Berlin}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iv/1.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{iptable rules für Hamburg}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iv/2.PNG} 
\end{center} 
%\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

v) After a successful IPSec connection has been established, create the following files using the given commands:\\
File ipsec\_ifconfig\_rsa.dump\\
ifconfig > ipsec\_ifconfig\_rsa.dump\\
File ipsec\_look\_rsa.dump\\
ipsec look > ipsec\_look\_rsa.dump\\
File ipsec\_route\_rsa.dump\\
route - n > ipsec\_route\_rsa.dump\\
The following files must be included with the lab report:\\
1) /etc/ipsec.secrets (rsa key)\\
2) /etc/ipsec.conf (rsa key)\\
3) ipsec\_ifconfig\_rsa.dump\\
4) ipsec\_look\_rsa.dump\\
5) ipsec\_route\_rsa.dump\\

\textbf{Files from Berlin:}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/bln/1.PNG} 
\end{center} 
%\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{1) /etc/ipsec.secrets }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/bln/2.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{2) /etc/ipsec.conf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/bln/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iv/1.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables ]{/etc/ipsec\_iptables }
\end{figure}

\textbf{4) ipsec\_ifconfig.dump }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/bln/4.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_ifconfig.dump]{ ipsec\_ifconfig.dump}
\end{figure}

\textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/bln/5.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_look.dump]{ ipsec\_look.dump}
\end{figure}

\textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/bln/6.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

\textbf{Files from Hamburg:}\\

\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/hh/1.PNG} 
\end{center} 
%\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{1) /etc/ipsec.secrets }\\
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/hh/2.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.secrets]{/etc/ipsec.secrets}
\end{figure}

\textbf{2) /etc/ipsec.conf }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/hh/3.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec.conf]{/etc/ipsec.conf}
\end{figure}

\textbf{3) /etc/ipsec\_iptables - a file which contains your iptables rules }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/iv/2.PNG} 
\end{center} 
\caption[Abbildung P5 /etc/ipsec\_iptables ]{/etc/ipsec\_iptables }
\end{figure}

\textbf{4) ipsec\_ifconfig.dump }
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/hh/4.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_ifconfig.dump]{ ipsec\_ifconfig.dump}
\end{figure}

\textbf{5) ipsec\_look.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/hh/5.PNG} 
\end{center} 
\caption[Abbildung P5  ipsec\_look.dump]{ ipsec\_look.dump}
\end{figure}

\textbf{6) ipsec\_route.dump}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1\textwidth]{bilder/screens/Part_5/aufgabe_9/v/hh/6.PNG} 
\end{center} 
\caption[Abbildung P5 ipsec\_route.dump]{ipsec\_route.dump}
\end{figure}

%\backmatter 

%\chapter{Literaturverzeichnis und Quellenverzeichnis}


\end{document}